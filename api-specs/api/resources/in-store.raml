type: base
uriParameters:
  storeKey:
    type: string
    description: '`key` of the [Store](ctp:api:type:Store).'
/carts:
  type:
    baseDomain:
      resourceType: Cart
      resourceQueryType: CartPagedQueryResponse
      resourceDraft: CartDraft
      whereExample: 'customerEmail = "john.doe@example.com"'
      sortExample: createdAt asc
  (updateable): Cart
  (deleteable): Cart
  (createable): CartDraft
  description: A shopping cart holds product variants and can be ordered.
  get:
    securedBy:
      [
        oauth_2_0:
          {
            scopes:
              [
                'view_orders:{projectKey}',
                'view_orders:{projectKey}:{storeKey}',
              ],
          },
      ]
    displayName: Query Carts in Store
    description: Retrieves Carts in a [Store](ctp:api:type:Store).
    responses:
      200:
        body:
          application/json:
            example: !include ../examples/carts.example.json
  head:
    displayName: Check if Cart exists in Store by Query Predicate
    securedBy:
      [
        oauth_2_0:
          {
            scopes:
              [
                'view_orders:{projectKey}',
                'view_orders:{projectKey}:{storeKey}',
              ],
          },
      ]
    description: Checks if one or more Carts exist for the provided query predicate in a [Store](ctp:api:type:Store). Returns a `200 OK` status if any Carts match the query predicate, or [Not Found](/../api/errors#404-not-found) otherwise.
    queryParameters:
      where?:
        type: QueryPredicate[]
  post:
    securedBy:
      [
        oauth_2_0:
          {
            scopes:
              [
                'manage_orders:{projectKey}',
                'manage_orders:{projectKey}:{storeKey}',
              ],
          },
      ]
    displayName: Create Cart in Store
    description: |
      Creates a Cart in a [Store](ctp:api:type:Store).

      If the referenced [ShippingMethod](ctp:api:type:ShippingMethod) in the [CartDraft](ctp:api:type:CartDraft) has a predicate that does not match, or if the Shipping Method is not active, an [InvalidOperation](ctp:api:type:InvalidOperationError) error is returned.

      Specific Error Codes:

      - [DiscountCodeNonApplicable](ctp:api:type:DiscountCodeNonApplicableError)
      - [InvalidItemShippingDetails](ctp:api:type:InvalidItemShippingDetailsError)
      - [MatchingPriceNotFound](ctp:api:type:MatchingPriceNotFoundError)
      - [MissingTaxRateForCountry](ctp:api:type:MissingTaxRateForCountryError)
      - [CountryNotConfiguredInStore](ctp:api:type:CountryNotConfiguredInStoreError)

    body:
      application/json:
        example: !include ../examples/cart-create.example.json
    responses:
      201:
        body:
          application/json:
            example: !include ../examples/cart.example.json
  /customer-id={customerId}:
    (methodName): withCustomerId
    type:
      baseResource:
        uriParameterName: customerId
        resourceType: Cart
    get:
      displayName: Get Cart in Store by Customer ID
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_orders:{projectKey}',
                  'view_orders:{projectKey}:{storeKey}',
                ],
            },
        ]
      description: |
        Retrieves the most recently modified [active Cart](ctp:api:type:CartState) of a Customer with [CartOrigin](ctp:api:type:CartOrigin) `Customer`. If no active Cart exists, this method returns a [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error.

        If the Cart exists in the Project but does not have a `store` specified, or the `store` field references a different Store, this method returns a [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error.

        To ensure the Cart is up-to-date with current values (such as Prices and Discounts), use the [Recalculate](ctp:api:type:CartRecalculateAction) update action.
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/cart.example.json
    head:
      displayName: Check if Cart exists in Store by Customer ID
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_orders:{projectKey}',
                  'view_orders:{projectKey}:{storeKey}',
                ],
            },
        ]
      description: Checks if one or more Carts exist for a Customer in a [Store](ctp:api:type:Store). Returns a `200 OK` status if the Cart exists or [Not Found](/../api/errors#404-not-found) otherwise.
  /key={key}:
    (methodName): withKey
    type:
      baseResource:
        uriParameterName: key
        resourceType: Cart
        resourceUpdateType: CartUpdate
    get:
      displayName: Get Cart in Store by Key
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_orders:{projectKey}',
                  'view_orders:{projectKey}:{storeKey}',
                ],
            },
        ]
      description: |

        Retrieves a Cart with the provided `key` in a [Store](ctp:api:type:Store).

        If the Cart exists in the Project but does not have a `store` specified, or the `store` field references a different Store, this method returns a [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error.

        To ensure the Cart is up-to-date with current values (such as Prices and Discounts), use the [Recalculate](ctp:api:type:CartRecalculateAction) update action.
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/cart.example.json
    head:
      displayName: Check if Cart exists in Store by Key
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_orders:{projectKey}',
                  'view_orders:{projectKey}:{storeKey}',
                ],
            },
        ]
      description: Checks if a Cart exists with the provided `key` in a [Store](ctp:api:type:Store). Returns a `200 OK` status if the Cart exists or [Not Found](/../api/errors#404-not-found) otherwise.
    post:
      displayName: Update Cart in Store by Key
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_orders:{projectKey}',
                  'manage_orders:{projectKey}:{storeKey}',
                ],
            },
        ]
      description: |
        Updates a Cart in a [Store](ctp:api:type:Store) using one or more [update actions](/../api/projects/carts#update-actions).

        If the Cart exists in the Project but does not have a `store` specified, or the `store` field references a different Store, this method returns a [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error.
      body:
        application/json:
          example: !include ../examples/cart-update.example.json
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/cart.example.json
    delete:
      displayName: Delete Cart in Store by Key
      description: |
        Deletes a Cart in a [Store](ctp:api:type:Store).

        If the Cart exists in the Project but does not have a `store` specified, or the `store` field references a different Store, this method returns a [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error.
      is:
        - dataErasure
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_orders:{projectKey}',
                  'manage_orders:{projectKey}:{storeKey}',
                ],
            },
        ]
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/cart.example.json
  /replicate:
    type: base
    post:
      displayName: Replicate Cart in Store
      description: |
        Creates a new Cart by replicating an existing Cart or Order. Can be useful in cases where a customer wants to cancel a recent order to make some changes or reorder a previous order.

        The replicated Cart preserves Customer information, Line Items and Custom Line Items, Custom Fields, Discount Codes, and other settings of the Cart or Order. If the Line Items become invalid, for example, due to removed Products or Prices, they are removed from the new Cart. If the Customer switches to another Customer Group, the new Cart is updated with the new value. It has up-to-date Tax Rates, Prices, and Line Item product data and is in `Active` [CartState](ctp:api:type:CartState).

        The new Cart does not contain payments or deliveries. The [State](ctp:api:type:ItemState) of Line Items and Custom Line Items is reset to `initial`.

        Specific Error Codes:

        - [MatchingPriceNotFound](ctp:api:type:MatchingPriceNotFoundError)
        - [MissingTaxRateForCountry](ctp:api:type:MissingTaxRateForCountryError)
      body:
        application/json:
          example: !include ../examples/cart-replicate.example.json
          type: ReplicaCartDraft
      responses:
        201:
          body:
            application/json:
              example: !include ../examples/cart.example.json
              type: Cart
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_orders:{projectKey}:{storeKey}',
                  'manage_orders:{projectKey}',
                ],
            },
        ]
  /{ID}:
    (methodName): withId
    type:
      baseResource:
        uriParameterName: ID
        resourceType: Cart
        resourceUpdateType: CartUpdate
    get:
      displayName: Get Cart in Store by ID
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_orders:{projectKey}',
                  'view_orders:{projectKey}:{storeKey}',
                ],
            },
        ]
      description: |
        Retrieves a Cart with the provided `id` in a [Store](ctp:api:type:Store).

        If the Cart exists in the Project but does not have a `store` specified, or the `store` field references a different Store, this method returns a [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error.

        To ensure the Cart is up-to-date with current values (such as Prices and Discounts), use the [Recalculate](ctp:api:type:CartRecalculateAction) update action.
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/cart.example.json
    head:
      displayName: Check if Cart exists in Store by ID
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_orders:{projectKey}',
                  'view_orders:{projectKey}:{storeKey}',
                ],
            },
        ]
      description: Checks if a Cart exists with the provided `id` in a Store. Returns a `200 OK` status if the Cart exists or [Not Found](/../api/errors#404-not-found) otherwise.
    post:
      displayName: Update Cart in Store by ID
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_orders:{projectKey}',
                  'manage_orders:{projectKey}:{storeKey}',
                ],
            },
        ]
      description: |
        Updates a Cart in a [Store](ctp:api:type:Store) using one or more [update actions](/../api/projects/carts#update-actions).

        If the Cart exists in the Project but does not have a `store` specified, or the `store` field references a different Store, this method returns a [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error.
      body:
        application/json:
          example: !include ../examples/cart-update.example.json
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/cart.example.json
    delete:
      displayName: Delete Cart in Store by ID
      description: |
        Deletes a Cart in a [Store](ctp:api:type:Store).

        If the Cart exists in the Project but does not have a `store` specified, or the `store` field references a different Store, this method returns a [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error.
      is:
        - dataErasure
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_orders:{projectKey}',
                  'manage_orders:{projectKey}:{storeKey}',
                ],
            },
        ]
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/cart.example.json
/orders:
  type:
    baseDomain:
      resourceType: Order
      resourceQueryType: OrderPagedQueryResponse
      resourceDraft: OrderFromCartDraft
      whereExample: 'customerEmail = "john.doe@example.com"'
      sortExample: createdAt asc
  (updateable): Order
  (deleteable): Order
  (createable): OrderFromCartDraft
  description:
    An order can be created from a cart, usually after a checkout process has
    been completed.
  get:
    displayName: Query Orders in Store
    description: Retrieves Orders in a [Store](ctp:api:type:Store).
    securedBy:
      [
        oauth_2_0:
          {
            scopes:
              [
                'view_orders:{projectKey}',
                'view_orders:{projectKey}:{storeKey}',
              ],
          },
      ]
    responses:
      200:
        body:
          application/json:
            example: !include ../examples/orders.example.json
  head:
    displayName: Check if Order exists in Store by Query Predicate
    securedBy:
      [
        oauth_2_0:
          {
            scopes:
              [
                'view_orders:{projectKey}',
                'view_orders:{projectKey}:{storeKey}',
              ],
          },
      ]
    description: Checks if one or more Orders exist for the provided query predicate in a [Store](ctp:api:type:Store). Returns a `200 OK` status if any Orders match the query predicate, or [Not Found](/../api/errors#404-not-found) otherwise.
    queryParameters:
      where?:
        type: QueryPredicate[]
  post:
    displayName: Create Order in Store
    securedBy:
      [
        oauth_2_0:
          {
            scopes:
              [
                'manage_orders:{projectKey}',
                'manage_orders:{projectKey}:{storeKey}',
              ],
          },
      ]
    description: |
      Creates an Order from a Cart in a [Store](ctp:api:type:Store).
      The Cart must have a shipping address and an active Shipping Method set.

      The shipping address is used for tax calculation for a Cart with `Platform` [TaxMode](ctp:api:type:TaxMode).

      Creating an Order produces the [OrderCreated](ctp:api:type:OrderCreatedMessage) Message.

      If a server-side problem occurs, indicated by a 500 Internal Server Error HTTP response, the Order creation may still successfully complete after the error is returned.
      If you receive this error, you should verify the status of the Order by querying a unique identifier supplied during the creation request, such as the Order number.

      Specific Error Codes:

      - [OutOfStock](ctp:api:type:OutOfStockError)
      - [PriceChanged](ctp:api:type:PriceChangedError)
      - [DiscountCodeNonApplicable](ctp:api:type:DiscountCodeNonApplicableError)
      - [ShippingMethodDoesNotMatchCart](ctp:api:type:ShippingMethodDoesNotMatchCartError)
      - [InvalidItemShippingDetails](ctp:api:type:InvalidItemShippingDetailsError)
      - [InvalidOperation](ctp:api:type:InvalidOperationError)
      - [MatchingPriceNotFound](ctp:api:type:MatchingPriceNotFoundError)
      - [MissingTaxRateForCountry](ctp:api:type:MissingTaxRateForCountryError)
      - [CountryNotConfiguredInStore](ctp:api:type:CountryNotConfiguredInStoreError)
    body:
      application/json:
        example: !include ../examples/order-create.example.json
    responses:
      201:
        body:
          application/json:
            example: !include ../examples/order.example.json
  /quotes:
    (methodName): orderQuote
    type: base
    displayName: Order from Quote
    post:
      displayName: Create Order in Store from Quote
      description: |

        Creates an Order from a [Quote](ctp:api:type:Quote) in a [Store](ctp:api:type:Store). The referenced Quote must have the `Pending` [state](ctp:api:type:QuoteState) and must be valid (not past the `validTo` date); otherwise, an [InvalidOperation](ctp:api:type:InvalidOperationError) error is returned.

        Produces the [OrderCreated](ctp:api:type:OrderCreatedMessage) Message.

        Specific Error Codes:

        - [OutOfStock](ctp:api:type:OutOfStockError)
        - [InvalidItemShippingDetails](ctp:api:type:InvalidItemShippingDetailsError)
        - [InvalidOperation](ctp:api:type:InvalidOperationError)
        - [CountryNotConfiguredInStore](ctp:api:type:CountryNotConfiguredInStoreError)
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_quotes:{projectKey}',
                  'manage_quotes:{projectKey}:{storeKey}',
                ],
            },
        ]
      body:
        application/json:
          example: !include ../examples/order-from-quote.example.json
          type: OrderFromQuoteDraft
      responses:
        201:
          body:
            application/json:
              example: !include ../examples/order.example.json
              type: Order
  /order-number={orderNumber}:
    (methodName): withOrderNumber
    uriParameters:
      orderNumber:
        type: string
        description: '`orderNumber` of the [Order](ctp:api:type:Order). Should be provided in URL-encoded format.'
    type:
      baseResource:
        uriParameterName: orderNumber
        resourceType: Order
        resourceUpdateType: OrderUpdate
    get:
      displayName: Get Order in Store by OrderNumber
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_orders:{projectKey}',
                  'view_orders:{projectKey}:{storeKey}',
                ],
            },
        ]
      description: |
        Retrieves an Order with the provided `orderNumber` in a [Store](ctp:api:type:Store).
        If the Order exists in the Project but does not have a `store` specified, or the `store` field references a different Store, this method returns a [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error.
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/order.example.json
    head:
      displayName: Check if Order exists in Store by OrderNumber
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_orders:{projectKey}',
                  'view_orders:{projectKey}:{storeKey}',
                ],
            },
        ]
      description: Checks if an Order exists with the provided `orderNumber` in a [Store](ctp:api:type:Store). Returns a `200 OK` status if the Order exists or [Not Found](/../api/errors#404-not-found) otherwise.
    post:
      displayName: Update Order in Store by OrderNumber
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_orders:{projectKey}',
                  'manage_orders:{projectKey}:{storeKey}',
                ],
            },
        ]
      description: |
        Updates an Order in a [Store](ctp:api:type:Store) using one or more [update actions](/../api/projects/orders#update-actions).
        If the Order exists in the Project but does not have a `store` specified, or the `store` field references a different Store, this method returns a [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error.
      body:
        application/json:
          example: !include ../examples/order-update.example.json
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/order.example.json
    delete:
      displayName: Delete Order in Store by OrderNumber
      description: |
        Deletes an Order in a [Store](ctp:api:type:Store).
        If the Order exists in the Project but does not have a `store` specified, or the `store` field references a different Store, this method returns a [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error.

        Deleting an Order produces the [OrderDeleted](ctp:api:type:OrderDeletedMessage) Message.
      is:
        - dataErasure
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_orders:{projectKey}',
                  'manage_orders:{projectKey}:{storeKey}',
                ],
            },
        ]
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/order.example.json
  /{ID}:
    (methodName): withId
    type:
      baseResource:
        uriParameterName: ID
        resourceType: Order
        resourceUpdateType: OrderUpdate
    get:
      displayName: Get Order in Store by ID
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_orders:{projectKey}',
                  'view_orders:{projectKey}:{storeKey}',
                ],
            },
        ]
      description: |
        Retrieves an Order with the provided `id` in a [Store](ctp:api:type:Store).
        If the Order exists in the Project but does not have a `store` specified, or the `store` field references a different Store, this method returns a [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error.
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/order.example.json
    head:
      displayName: Check if My Order exists in Store by ID
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_orders:{projectKey}',
                  'view_orders:{projectKey}:{storeKey}',
                ],
            },
        ]
      description: Checks if an Order exists with the provided `id` in a [Store](ctp:api:type:Store). Returns a `200 OK` status if the Order exists or [Not Found](/../api/errors#404-not-found) otherwise.
    post:
      displayName: Update Order in Store by ID
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_orders:{projectKey}',
                  'manage_orders:{projectKey}:{storeKey}',
                ],
            },
        ]
      description: |
        Updates an Order in a [Store](ctp:api:type:Store) using one or more [update actions](/../api/projects/orders#update-actions).
        If the Order exists in the Project but does not have a `store` specified, or the `store` field references a different Store, this method returns a [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error.
      body:
        application/json:
          example: !include ../examples/order-update.example.json
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/order.example.json
    delete:
      displayName: Delete Order in Store by ID
      description: |
        Deletes an Order in a [Store](ctp:api:type:Store).
        If the Order exists in the Project but does not have a `store` specified, or the `store` field references a different Store, this method returns a [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error.

        Deleting an Order produces the [OrderDeleted](ctp:api:type:OrderDeletedMessage) Message.
      is:
        - dataErasure
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_orders:{projectKey}',
                  'manage_orders:{projectKey}:{storeKey}',
                ],
            },
        ]
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/order.example.json
/me:
  /carts:
    type:
      baseDomain:
        resourceType: Cart
        resourceQueryType: CartPagedQueryResponse
        resourceDraft: MyCartDraft
        whereExample: 'customerEmail = "john.doe@example.com"'
        sortExample: createdAt asc
    (updateable): Cart
    (deleteable): Cart
    (createable): MyCartDraft
    description: A shopping cart holds product variants and can be ordered.
    get:
      displayName: Query My Carts in Store
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_my_orders:{projectKey}',
                  'manage_my_orders:{projectKey}:{storeKey}',
                  'customer_id:{id}',
                  'anonymous_id:{id}',
                ],
            },
        ]
      description: |
        Retrieves Carts for the authenticated Customer or anonymous user in a [Store](ctp:api:type:Store).
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/carts.example.json
    head:
      displayName: Check if My Cart exists in Store by Query Predicate
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_my_orders:{projectKey}',
                  'manage_my_orders:{projectKey}:{storeKey}',
                  'customer_id:{id}',
                  'anonymous_id:{id}',
                ],
            },
        ]
      description: |
        Checks if a Cart exists for a Store that matches the given Query Predicate, and contains a matching `customerId` or `anonymousId`. Returns a `200 OK` status if any Carts match these conditions, or [Not Found](/../api/errors#404-not-found) otherwise.
      queryParameters:
        where?:
          type: QueryPredicate[]
    post:
      displayName: Create My Cart in Store
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_my_orders:{projectKey}',
                  'manage_my_orders:{projectKey}:{storeKey}',
                  'customer_id:{id}',
                  'anonymous_id:{id}',
                ],
            },
        ]
      description: |

        Creates a Cart in a Store for the Customer or anonymous user. The `customerId` or `anonymousId` field on the Cart is automatically set based on the [customer:{id}](/scopes#composable-commerce-oauth) or [anonymous_id:{id}](/scopes#composable-commerce-oauth) scope.

        The `store` field in the created [Cart](ctp:api:type:Cart) is set to the Store specified by the `storeKey` path parameter.

        Specific Error Codes:

        - [CountryNotConfiguredInStore](ctp:api:type:CountryNotConfiguredInStoreError)
        - [DiscountCodeNonApplicable](ctp:api:type:DiscountCodeNonApplicableError)
        - [InvalidItemShippingDetails](ctp:api:type:InvalidItemShippingDetailsError)
        - [MatchingPriceNotFound](ctp:api:type:MatchingPriceNotFoundError)
        - [MissingTaxRateForCountry](ctp:api:type:MissingTaxRateForCountryError)

      body:
        application/json:
          example: !include ../examples/cart-create.example.json
      responses:
        201:
          body:
            application/json:
              example: !include ../examples/cart.example.json
    /{ID}:
      (methodName): withId
      type:
        baseResource:
          uriParameterName: ID
          resourceType: Cart
          resourceUpdateType: MyCartUpdate
      get:
        displayName: Get My Cart in Store by ID
        securedBy:
          [
            oauth_2_0:
              {
                scopes:
                  [
                    'manage_my_orders:{projectKey}',
                    'manage_my_orders:{projectKey}:{storeKey}',
                    'customer_id:{id}',
                    'anonymous_id:{id}',
                  ],
              },
          ]
        description: |
          Returns a Cart for a given `id` in a Store. Returns a `200 OK` status if the Cart exists.

          A [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error is returned in the following scenarios:

          - If no Cart exists in the Store for the given `id`.
          - If the Cart exists but does not belong to a Store, or the Cart's `store` field references a different Store.
          - If the Cart exists but does not have either a `customerId` that matches the [customer:{id}](/scopes#composable-commerce-oauth) scope, or an `anonymousId` that matches the [anonymous_id:{id}](/scopes#composable-commerce-oauth) scope.

        responses:
          200:
            body:
              application/json:
                example: !include ../examples/cart.example.json
      head:
        displayName: Check if My Cart exists in Store by ID
        securedBy:
          [
            oauth_2_0:
              {
                scopes:
                  [
                    'manage_my_orders:{projectKey}',
                    'manage_my_orders:{projectKey}:{storeKey}',
                    'customer_id:{id}',
                    'anonymous_id:{id}',
                  ],
              },
          ]
      post:
        displayName: Update My Cart in Store by ID
        securedBy:
          [
            oauth_2_0:
              {
                scopes:
                  [
                    'manage_my_orders:{projectKey}',
                    'manage_my_orders:{projectKey}:{storeKey}',
                    'customer_id:{id}',
                    'anonymous_id:{id}',
                  ],
              },
          ]
        description: |
          Updates the Cart for a given `id` in a Store. Returns a `200 OK` status if successful.

          A [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error is returned in the following scenarios:

          - If no Cart exists in the Store for the given `id`.
          - If the Cart exists but does not belong to a Store, or the Cart's `store` field references a different Store.
          - If the Cart exists but does not have either a `customerId` that matches the [customer:{id}](/scopes#composable-commerce-oauth) scope, or an `anonymousId` that matches the [anonymous_id:{id}](/scopes#composable-commerce-oauth) scope.

        body:
          application/json:
            example: !include ../examples/cart-update.example.json
        responses:
          200:
            body:
              application/json:
                example: !include ../examples/cart.example.json
      delete:
        displayName: Delete My Cart in Store by ID
        securedBy:
          [
            oauth_2_0:
              {
                scopes:
                  [
                    'manage_my_orders:{projectKey}',
                    'manage_my_orders:{projectKey}:{storeKey}',
                    'customer_id:{id}',
                    'anonymous_id:{id}',
                  ],
              },
          ]
        description: |
          Deletes the Cart for a given `id` in a Store. Returns a `200 OK` status if successful.

          A [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error is returned in the following scenarios:

          - If no Cart exists in the Store for the given `id`.
          - If the Cart exists in the Project but does not belong to a Store, or the Cart's `store` field references a different Store.
          - If the Cart exists in the Project but does not have either a `customerId` that matches the [customer:{id}](/scopes#composable-commerce-oauth) scope, or an `anonymousId` that matches the [anonymous_id:{id}](/scopes#composable-commerce-oauth) scope.

        responses:
          200:
            body:
              application/json:
                example: !include ../examples/cart.example.json
  /orders:
    type:
      baseDomain:
        resourceType: Order
        resourceQueryType: OrderPagedQueryResponse
        resourceDraft: MyOrderFromCartDraft
        whereExample: 'customerEmail = "john.doe@example.com"'
        sortExample: createdAt asc
    description:
      An order can be created from a order, usually after a checkout process has
      been completed.
    get:
      displayName: Query My Orders in Store
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_my_orders:{projectKey}',
                  'manage_my_orders:{projectKey}:{storeKey}',
                  'customer_id:{id}',
                  'anonymous_id:{id}',
                ],
            },
        ]
      description: |
        Retrieves Orders in a [Store](ctp:api:type:Store) for the authenticated Customer or anonymous user.

        A [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error is returned in the following scenarios:

        - If no Orders exist that match the provided query predicate.
        - If an Order exists but does not have a `customerId` that matches the [customer:{id}](/scopes#composable-commerce-oauth) scope, or `anonymousId` that matches the [anonymous_id:{id}](/scopes#composable-commerce-oauth) scope.

      responses:
        200:
          body:
            application/json:
              example: !include ../examples/orders.example.json
    head:
      displayName: Check if My Order exists in Store by Query Predicate
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_my_orders:{projectKey}',
                  'manage_my_orders:{projectKey}:{storeKey}',
                  'customer:{customerId}',
                  'anonymous_id:{anonymousId}',
                ],
            },
        ]
      description: |
        Checks if one or more Orders exist for the provided query predicate in a [Store](ctp:api:type:Store) for the authenticated Customer or anonymous user. Returns a `200 OK` status if successful.

        A [Not Found](/../api/errors#404-not-found) error is returned in the following scenarios:

        - If no Orders exist in the Store that match the Query Predicate.
        - If an Order matches the Query Predicate, but no `store` is specified, or the `store` field references a different Store.
        - If an Order matches the Query Predicate, but does not have a `customerId` that matches the [customer:{id}](/scopes#composable-commerce-oauth) scope, or an `anonymousId` that matches the [anonymous_id:{id}](/scopes#composable-commerce-oauth) scope.

      queryParameters:
        where?:
          type: QueryPredicate[]
    post:
      is:
        - conflicting
      displayName: Create My Order in Store from Cart
      description: |

        Creates an Order from a Cart in a [Store](ctp:api:type:Store) for the Customer or anonymous user. The `customerId` or `anonymousId` field on the Order is automatically set based on the [customer:{id}](/scopes#composable-commerce-oauth) or [anonymous_id:{id}](/scopes#composable-commerce-oauth) scope.

        The Cart must have a shipping address and an active Shipping Method set.

        When creating [B2B Orders](/associates-overview#b2b-resources), the Customer must have the `CreateMyOrdersFromMyCarts` [Permission](ctp:api:type:Permission).

        If the Cart's `customerId` does not match the [customer:{id}](/scopes#composable-commerce-oauth) scope, or the `anonymousId` does not match the [anonymous_id:{id}](/scopes#composable-commerce-oauth) scope, a [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error is returned.

        Creating an Order produces the [OrderCreated](ctp:api:type:OrderCreatedMessage) Message.

        Specific Error Codes:

        - [AssociateMissingPermission](ctp:api:type:AssociateMissingPermissionError)
        - [CountryNotConfiguredInStore](ctp:api:type:CountryNotConfiguredInStoreError)
        - [DiscountCodeNonApplicable](ctp:api:type:DiscountCodeNonApplicableError)
        - [InvalidItemShippingDetails](ctp:api:type:InvalidItemShippingDetailsError)
        - [MatchingPriceNotFound](ctp:api:type:MatchingPriceNotFoundError)
        - [MissingTaxRateForCountry](ctp:api:type:MissingTaxRateForCountryError)
        - [OutOfStock](ctp:api:type:OutOfStockError)
        - [PriceChanged](ctp:api:type:PriceChangedError)
        - [ShippingMethodDoesNotMatchCart](ctp:api:type:ShippingMethodDoesNotMatchCartError)
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_my_orders:{projectKey}',
                  'manage_my_orders:{projectKey}:{storeKey}',
                  'customer_id:{id}',
                  'anonymous_id:{id}',
                ],
            },
        ]
      body:
        application/json:
          example: !include ../examples/my-order-create.example.json
      responses:
        201:
          body:
            application/json:
              example: !include ../examples/order.example.json
    /{ID}:
      (methodName): withId
      type:
        baseResource:
          uriParameterName: ID
          resourceType: Order
      get:
        displayName: Get My Order in Store by ID
        description: |
          Retrieves an Order with the provided `id` in a [Store](ctp:api:type:Store) for the authenticated Customer or anonymous user. Returns a `200 OK` status if successful.

          A [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error is returned in the following scenarios:

          - If no Orders exists in the Store with the provided `id`.
          - If an Order exists but does not have a `store` specified, or the `store` field references a different Store.
          - If an Order exists but does not have a `customerId` that matches the [customer:{id}](/scopes#composable-commerce-oauth) scope, or `anonymousId` that matches the [anonymous_id:{id}](/scopes#composable-commerce-oauth) scope.

        securedBy:
          [
            oauth_2_0:
              {
                scopes:
                  [
                    'manage_my_orders:{projectKey}',
                    'manage_my_orders:{projectKey}:{storeKey}',
                    'customer_id:{id}',
                    'anonymous_id:{id}',
                  ],
              },
          ]
        responses:
          200:
            body:
              application/json:
                example: !include ../examples/order.example.json
      head:
        displayName: Check if My Order exists in Store by ID
        securedBy:
          [
            oauth_2_0:
              {
                scopes:
                  [
                    'manage_my_orders:{projectKey}',
                    'manage_my_orders:{projectKey}:{storeKey}',
                    'customer_id:{id}',
                    'anonymous_id:{id}',
                  ],
              },
          ]
        description: |
          Checks if an Order exists with the provided `id` in a [Store](ctp:api:type:Store) for the authenticated Customer or anonymous user. Returns a `200 OK` status if successful.

          A [Not Found](/../api/errors#404-not-found) error is returned in the following scenarios:

          - If no Order exists in the Store with the provided `id`.
          - If an Order exists but does not have a `store` specified, or the `store` field references a different Store.
          - If an Order exists but does not have a `customerId` that matches the [customer:{id}](/scopes#composable-commerce-oauth) scope, or `anonymousId` that matches the [anonymous_id:{id}](/scopes#composable-commerce-oauth) scope.

  /active-cart:
    type: base
    get:
      displayName: Get My active Cart in Store
      description: |
        Retrieves the Customer's most recently modified [active Cart](ctp:api:type:CartState) in a Store. Returns a `200 OK` status if successful.

        Carts with `Merchant` or `Quote` [CartOrigin](ctp:api:type:CartOrigin) are ignored.

        A [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error is returned in the following scenarios:

        - If no active Cart exists.
        - If an active Cart exists but does not have a `store` specified, or the `store` field references a different Store.
        - If an active Cart exists but does not have a `customerId` that matches the [customer:{id}](/scopes#composable-commerce-oauth) scope, or `anonymousId` that matches the [anonymous_id:{id}](/scopes#composable-commerce-oauth) scope.

      is:
        - expandable
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_my_orders:{projectKey}',
                  'manage_my_orders:{projectKey}:{storeKey}',
                  'customer_id:{id}',
                  'anonymous_id:{id}',
                ],
            },
        ]
      responses:
        200:
          body:
            application/json:
              type: Cart
              example: !include ../examples/cart.example.json
    head:
      displayName: Check if active Cart exists in Store
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_my_orders:{projectKey}',
                  'manage_my_orders:{projectKey}:{storeKey}',
                  'customer_id:{id}',
                  'anonymous_id:{id}',
                ],
            },
        ]
      description: |
        Checks if an active Cart exists in a Store. Returns `200 OK` status if successful.

        A [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error is returned in the following scenarios:

        - If no active Cart exists in a Store.
        - If an active Cart exists but does not have a `store` specified, or the `store` field references a different Store.
        - If an active Cart exists but does not contain a `customerId` that matches the [customer:{id}](/scopes#composable-commerce-oauth) scope, or `anonymousId` that matches the [anonymous_id:{id}](/scopes#composable-commerce-oauth) scope.

  /shopping-lists:
    type:
      baseDomain:
        resourceType: ShoppingList
        resourceQueryType: ShoppingListPagedQueryResponse
        resourceDraft: MyShoppingListDraft
        whereExample: 'key = "my-shopping-list"'
        sortExample: createdAt asc
    description: |
      shopping-lists e.g. for wishlist support
    get:
      displayName: Query My ShoppingLists in Store
      description: |
        Retrieves ShoppingLists for the authenticated Customer or anonymous user in a [Store](ctp:api:type:Store). Returns `200 OK` status if successful.

        A [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error is returned in the following scenarios:

        - If no ShoppingLists exist in a Store.
        - If a ShoppingList exists but does not have a `store` specified, or the `store` field references a different Store.
        - If a ShoppingList exists in a Store but does not contain either an `anonymousId` that matches the [anonymous_id:{id}](/scopes#composable-commerce-oauth) scope, or a `customer` with `id` value that matches the [customer:{id}](/scopes#composable-commerce-oauth) scope.

      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_my_shopping_lists:{projectKey}',
                  'manage_my_shopping_lists:{projectKey}:{storeKey}',
                  'customer_id:{id}',
                  'anonymous_id:{id}',
                ],
            },
        ]
      queryParameters:
        expand:
          description: |
            When expanding `variant` and `productSlug` on [ShoppingListLineItem](ctp:api:type:ShoppingListLineItem), [expand the entire array](/general-concepts#reference-expansion). You cannot expand a single element (for example, `expand=lineItems[0].variant` is not supported).
          type: Expansion[]
          required: false
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/shopping-lists.example.json
    head:
      displayName: Check if My ShoppingList exists in Store by Query Predicate
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_my_shopping_lists:{projectKey}',
                  'manage_my_shopping_lists:{projectKey}:{storeKey}',
                  'customer_id:{id}',
                  'anonymous_id:{id}',
                ],
            },
        ]
      description: |
        Checks if one or more ShoppingLists exist for the provided query predicate for the authenticated Customer or anonymous user in a [Store](ctp:api:type:Store). Returns `200 OK` status if successful.

        A [Not Found](/../api/errors#404-not-found) error is returned in the following scenarios:

        - If no ShoppingLists exist for the provided query predicate in a Store.
        - If a ShoppingList matches the query predicate but does not have a `store` specified, or the `store` field references a different Store.
        - If a ShoppingList exists in a Store but does not contain either an `anonymousId` that matches the [anonymous_id:{id}](/scopes#composable-commerce-oauth) scope, or a `customer` with `id` value that matches the [customer:{id}](/scopes#composable-commerce-oauth) scope.

      queryParameters:
        where?:
          type: QueryPredicate[]
    post:
      displayName: Create My ShoppingList in Store
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_my_shopping_lists:{projectKey}',
                  'manage_my_shopping_lists:{projectKey}:{storeKey}',
                  'customer_id:{id}',
                  'anonymous_id:{id}',
                ],
            },
        ]
      queryParameters:
        expand:
          description: |
            When expanding `variant` and `productSlug` on [ShoppingListLineItem](ctp:api:type:ShoppingListLineItem), [expand the entire array](/general-concepts#reference-expansion). You cannot expand a single element (for example, `expand=lineItems[0].variant` is not supported).
          type: Expansion[]
          required: false
      body:
        application/json:
          example: !include ../examples/shopping-list-create.example.json
      description: |

        Creates a ShoppingList for the authenticated Customer or anonymous user in a [Store](ctp:api:type:Store). The `customer` or `anonymousId` field on the ShoppingList is automatically set based on the given [customer:{id}](/scopes#composable-commerce-oauth) or [anonymous_id:{id}](/scopes#composable-commerce-oauth) scope.

        When using this endpoint, the `store` field of a ShoppingList is always set to the Store specified in the path parameter.
      responses:
        201:
          body:
            application/json:
              example: !include ../examples/shopping-list.example.json
    /key={key}:
      (methodName): withKey
      type:
        baseResource:
          uriParameterName: key
          resourceType: ShoppingList
          resourceUpdateType: MyShoppingListUpdate
      get:
        displayName: Get My ShoppingList in Store by Key
        securedBy:
          [
            oauth_2_0:
              {
                scopes:
                  [
                    'manage_my_shopping_lists:{projectKey}',
                    'manage_my_shopping_lists:{projectKey}:{storeKey}',
                    'customer_id:{id}',
                    'anonymous_id:{id}',
                  ],
              },
          ]
        queryParameters:
          expand:
            description: |
              When expanding `variant` and `productSlug` on [ShoppingListLineItem](ctp:api:type:ShoppingListLineItem), [expand the entire array](/general-concepts#reference-expansion). You cannot expand a single element (for example, `expand=lineItems[0].variant` is not supported).
            type: Expansion[]
            required: false
        description: |
          Retrieves a ShoppingList with the provided `key` for the authenticated Customer or anonymous user in a [Store](ctp:api:type:Store). Returns `200 OK` status if successful.

          A [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error is returned in the following scenarios:

          - If no ShoppingList matches the provided `key` in a Store.
          - If a ShoppingList matches the provided `key` but does not have a `store` specified, or the `store` field references a different Store.
          - If a ShoppingList matches the provided `key` in a Store but does not contain either an `anonymousId` that matches the [anonymous_id:{id}](/scopes#composable-commerce-oauth) scope,
             or a `customer` with `id` value that matches the [customer:{id}](/scopes#composable-commerce-oauth) scope.

        responses:
          200:
            body:
              application/json:
                example: !include ../examples/shopping-list.example.json
      head:
        displayName: Check if My ShoppingList exists in Store by Key
        securedBy:
          [
            oauth_2_0:
              {
                scopes:
                  [
                    'manage_my_shopping_lists:{projectKey}',
                    'manage_my_shopping_lists:{projectKey}:{storeKey}',
                    'customer_id:{id}',
                    'anonymous_id:{id}',
                  ],
              },
          ]
        description: |
          Checks if a ShoppingList exists with the provided `key` for the authenticated Customer or anonymous user in a [Store](ctp:api:type:Store). Returns a `200 OK` status if successful.

          A [Not Found](/../api/errors#404-not-found) error is returned in the following scenarios:

          - If no ShoppingList exists that matches the provided `key` in a Store.
          - If a ShoppingList matches the provided `key` but does not have a `store` specified, or the `store` field references a different Store.
          - If a ShoppingList matches the provided `key` in a Store but does not contain either an `anonymousId` that matches the [anonymous_id:{id}](/scopes#composable-commerce-oauth) scope, or a `customer` with `id` value that matches the [customer:{id}](/scopes#composable-commerce-oauth) scope.

      post:
        displayName: Update My ShoppingList in Store by Key
        securedBy:
          [
            oauth_2_0:
              {
                scopes:
                  [
                    'manage_my_shopping_lists:{projectKey}',
                    'manage_my_shopping_lists:{projectKey}:{storeKey}',
                    'customer_id:{id}',
                    'anonymous_id:{id}',
                  ],
              },
          ]
        queryParameters:
          expand:
            description: |
              When expanding `variant` and `productSlug` on [ShoppingListLineItem](ctp:api:type:ShoppingListLineItem), [expand the entire array](/general-concepts#reference-expansion). You cannot expand a single element (for example, `expand=lineItems[0].variant` is not supported).
            type: Expansion[]
            required: false
        body:
          application/json:
            example: !include ../examples/shopping-list-update.example.json
        description: |
          Updates a ShoppingList for the authenticated Customer or anonymous user in a [Store](ctp:api:type:Store) using one or more [update actions](/../api/projects/me-shoppingLists#update-actions). Returns a `200 OK` status if successful.

          A [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error is returned in the following scenarios:

          - If no ShoppingList matches the provided `key` in a Store.
          - If a ShoppingList matches the provided `key` but does not have a `store` specified, or the `store` field references a different Store.
          - If a ShoppingList matches the provided `key` in a Store but does not contain either an `anonymousId` that matches the [anonymous_id:{id}](/scopes#composable-commerce-oauth) scope, or a `customer` with `id` value that matches the [customer:{id}](/scopes#composable-commerce-oauth) scope.

        responses:
          200:
            body:
              application/json:
                example: !include ../examples/shopping-list.example.json
      delete:
        displayName: Delete My ShoppingList in Store by Key
        is:
          - dataErasure
        securedBy:
          [
            oauth_2_0:
              {
                scopes:
                  [
                    'manage_my_shopping_lists:{projectKey}',
                    'manage_my_shopping_lists:{projectKey}:{storeKey}',
                    'customer_id:{id}',
                    'anonymous_id:{id}',
                  ],
              },
          ]
        queryParameters:
          expand:
            description: |
              When expanding `variant` and `productSlug` on [ShoppingListLineItem](ctp:api:type:ShoppingListLineItem), [expand the entire array](/general-concepts#reference-expansion). You cannot expand a single element (for example, `expand=lineItems[0].variant` is not supported).
            type: Expansion[]
            required: false
        description: |
          Deletes a ShoppingList in a [Store](ctp:api:type:Store). Returns a `200 OK` status if successful.

          A [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error is returned in the following scenarios:

          - If no ShoppingList matches the provided `key` in a Store.
          - If a ShoppingList matches the provided `key` but does not have a `store` specified, or the `store` field references a different Store.
          - If a ShoppingList matches the provided `key` in a Store but does not contain either an `anonymousId` that matches the [anonymous_id:{id}](/scopes#composable-commerce-oauth) scope, or a `customer` with `id` value that matches the [customer:{id}](/scopes#composable-commerce-oauth) scope.

        responses:
          200:
            body:
              application/json:
                example: !include ../examples/shopping-list.example.json
    /{ID}:
      (methodName): withId
      type:
        baseResource:
          uriParameterName: ID
          resourceType: ShoppingList
          resourceUpdateType: MyShoppingListUpdate
      get:
        displayName: Get My ShoppingList in Store by ID
        securedBy:
          [
            oauth_2_0:
              {
                scopes:
                  [
                    'manage_my_shopping_lists:{projectKey}:{storeKey}',
                    'manage_my_shopping_lists:{projectKey}',
                    'customer_id:{id}',
                    'anonymous_id:{id}',
                  ],
              },
          ]
        queryParameters:
          expand:
            description: |
              When expanding `variant` and `productSlug` on [ShoppingListLineItem](ctp:api:type:ShoppingListLineItem), [expand the entire array](/general-concepts#reference-expansion). You cannot expand a single element (for example, `expand=lineItems[0].variant` is not supported).
            type: Expansion[]
            required: false
        description: |
          Retrieves a ShoppingList with the provided `id` for the authenticated Customer or anonymous user in a [Store](ctp:api:type:Store). Returns `200 OK` status if successful.

          A [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error is returned in the following scenarios:

          - If no ShoppingList matches the provided `id` in a Store.
          - If a ShoppingList matches the provided `id` but does not have a `store` specified, or the `store` field references a different Store.
          - If a ShoppingList matches the provided `id` in a Store but does not contain either an `anonymousId` that matches the [anonymous_id:{id}](/scopes#composable-commerce-oauth) scope, or a `customer` with `id` value that matches the [customer:{id}](/scopes#composable-commerce-oauth) scope.

        responses:
          200:
            body:
              application/json:
                example: !include ../examples/shopping-list.example.json
      head:
        displayName: Check if My ShoppingList exists in Store by ID
        securedBy:
          [
            oauth_2_0:
              {
                scopes:
                  [
                    'manage_my_shopping_lists:{projectKey}:{storeKey}',
                    'manage_my_shopping_lists:{projectKey}',
                    'customer_id:{id}',
                    'anonymous_id:{id}',
                  ],
              },
          ]
        description: |
          Checks if a ShoppingList exists with the provided `id` for the authenticated Customer or anonymous user in a [Store](ctp:api:type:Store). Returns a `200 OK` status if successful.

          A [Not Found](/../api/errors#404-not-found) error is returned in the following scenarios:

          - If no ShoppingList matches the provided `id` in a Store.
          - If a ShoppingList matches the provided `id` but does not have a `store` specified, or the `store` field references a different Store.
          - If a ShoppingList matches the provided `id` in a Store but does not contain either an `anonymousId` that matches the [anonymous_id:{id}](/scopes#composable-commerce-oauth) scope, or a `customer` with `id` value that matches the [customer:{id}](/scopes#composable-commerce-oauth) scope.

      post:
        displayName: Update My ShoppingList in Store by ID
        securedBy:
          [
            oauth_2_0:
              {
                scopes:
                  [
                    'manage_my_shopping_lists:{projectKey}',
                    'manage_my_shopping_lists:{projectKey}:{storeKey}',
                    'customer_id:{id}',
                    'anonymous_id:{id}',
                  ],
              },
          ]
        queryParameters:
          expand:
            description: |
              When expanding `variant` and `productSlug` on [ShoppingListLineItem](ctp:api:type:ShoppingListLineItem), [expand the entire array](/general-concepts#reference-expansion). You cannot expand a single element (for example, `expand=lineItems[0].variant` is not supported).
            type: Expansion[]
            required: false
        body:
          application/json:
            example: !include ../examples/shopping-list-update.example.json
        description: |
          Updates a ShoppingList for the authenticated Customer or anonymous user in a [Store](ctp:api:type:Store) using one or more [update actions](/../api/projects/me-shoppingLists#update-actions). Returns a `200 OK` status if successful.

          A [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error is returned in the following scenarios:

          - If no ShoppingList matches the provided `id` in a Store.
          - If a ShoppingList matches the provided `id` but does not have a `store` specified, or the `store` field references a different Store.
          - If a ShoppingList matches the provided `id` in a Store but does not contain either an `anonymousId` that matches the [anonymous_id:{id}](/scopes#composable-commerce-oauth) scope, or a `customer` with `id` value that matches the [customer:{id}](/scopes#composable-commerce-oauth) scope.

        responses:
          200:
            body:
              application/json:
                example: !include ../examples/shopping-list.example.json
      delete:
        displayName: Delete My ShoppingList in Store by ID
        is:
          - dataErasure
        securedBy:
          [
            oauth_2_0:
              {
                scopes:
                  [
                    'manage_my_shopping_lists:{projectKey}',
                    'manage_my_shopping_lists:{projectKey}:{storeKey}',
                    'customer_id:{id}',
                    'anonymous_id:{id}',
                  ],
              },
          ]
        queryParameters:
          expand:
            description: |
              When expanding `variant` and `productSlug` on [ShoppingListLineItem](ctp:api:type:ShoppingListLineItem), [expand the entire array](/general-concepts#reference-expansion). You cannot expand a single element (for example, `expand=lineItems[0].variant` is not supported).
            type: Expansion[]
            required: false
        description: |
          Deletes a ShoppingList in a [Store](ctp:api:type:Store). Returns a `200 OK` status if successful.

          A [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error is returned in the following scenarios:

          - If no ShoppingList matches the provided `id` in a Store.
          - If a ShoppingList matches the provided `id` but does not have a `store` specified, or the `store` field references a different Store.
          - If a ShoppingList matches the provided `id` in a Store but does not contain either an `anonymousId` that matches the [anonymous_id:{id}](/scopes#composable-commerce-oauth) scope, or a `customer` with `id` value that matches the [customer:{id}](/scopes#composable-commerce-oauth) scope.

        responses:
          200:
            body:
              application/json:
                example: !include ../examples/shopping-list.example.json
  get:
    displayName: Get My Customer in Store
    is:
      - sortable:
          sortExample: createdAt asc
      - paging
      - expandable
      - query:
          whereExample: 'customerEmail = "email@example.com"'
    securedBy:
      [
        oauth_2_0:
          {
            scopes:
              [
                'manage_my_profile:{projectKey}',
                'manage_my_profile:{projectKey}:{storeKey}',
                'customer_id:{id}',
              ],
          },
      ]
    description: |
      Returns a Customer for a given Query Predicate in a [Store](ctp:api:type:Store). Returns a `200 OK` status if successful.

      A [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error is returned in the following scenarios:

      - If no Customer exists in the Store for the given Query Predicate.
      - If a Customer exists in the Store for the given Query Predicate, but does not have an `id` value that matches the [customer:{id}](/scopes#composable-commerce-oauth) scope.
      - If a Customer exists for the given Query Predicate but is associated with a different Store than what is specified in the `manage_my_profile:{projectKey}:{storeKey}` scope.

    responses:
      200:
        body:
          application/json:
            example: !include ../examples/customer.example.json
            type: Customer
  post:
    displayName: Update My Customer in Store
    securedBy:
      [
        oauth_2_0:
          {
            scopes:
              [
                'manage_my_profile:{projectKey}',
                'manage_my_profile:{projectKey}:{storeKey}',
                'customer_id:{id}',
              ],
          },
      ]
    description: |
      Updates the Customer in a [Store](ctp:api:type:Store). Returns a `200 OK` status if successful.

      A [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error is returned in the following scenarios:

      - If no Customer exists with the `id` specified in the [customer:{id}](/scopes#composable-commerce-oauth) scope.
      - If the Customer exists but is associated with a different Store than what is specified in the `manage_my_profile:{projectKey}:{storeKey}` scope.

    body:
      application/json:
        example: !include ../examples/customer-update.example.json
        type: MyCustomerUpdate
    responses:
      200:
        body:
          application/json:
            example: !include ../examples/customer-update-response.example.json
            type: Customer
  delete:
    displayName: Delete My Customer in Store
    is:
      - versioned
      - conflicting
    securedBy:
      [
        oauth_2_0:
          {
            scopes:
              [
                'manage_my_profile:{projectKey}',
                'manage_my_profile:{projectKey}:{storeKey}',
                'customer_id:{id}',
              ],
          },
      ]
    description: |
      Deletes the Customer in a [Store](ctp:api:type:Store). Returns a `200 OK` status if successful.

      A [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error is returned in the following scenarios:

      - If no Customer exists with the `id` specified in the [customer:{id}](/scopes#composable-commerce-oauth) scope.
      - If the Customer exists but is associated with a different Store than what is specified in the `manage_my_profile:{projectKey}:{storeKey}` scope.

    responses:
      200:
        body:
          application/json:
            example: !include ../examples/customer.example.json
            type: Customer
  /email/confirm:
    type: base
    post:
      displayName: Verify email of My Customer in Store
      description: |
        This is the last step in the [email verification process of a Customer](/../api/projects/customers#email-verification-of-customer-in-store). Returns a `200 OK` status if successful.

        After the email is verified, all email tokens issued previously through the [email verification flow](/../api/projects/customers#email-verification-of-customer) are invalidated. This invalidation of tokens is [eventually consistent](/../api/general-concepts#eventual-consistency).

        A [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error is returned in the following scenarios:

        - If no Customer exists with the `id` specified in the [customer:{id}](/scopes#composable-commerce-oauth) scope.
        - If the Customer exists but is associated with a different Store than what is specified in the `manage_my_profile:{projectKey}:{storeKey}` scope.
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_my_profile:{projectKey}',
                  'manage_my_profile:{projectKey}:{storeKey}',
                  'customer_id:{id}',
                ],
            },
        ]
      body:
        application/json:
          example: !include ../examples/Customer/CustomerEmailVerify.json
          type: MyCustomerEmailVerify
      responses:
        200:
          description: The email was verified.
          body:
            application/json:
              example: !include ../examples/customer.example.json
              type: Customer
        400:
          description: An [ExpiredCustomerEmailToken](ctp:api:type:ExpiredCustomerEmailToken) error is returned as the provided token is has expired.
        404:
          description: The provided token is invalid or does not exist.
  /password:
    type: base
    post:
      displayName: Change password of My Customer in Store
      description: |
        Changing the password of the Customer produces the [CustomerPasswordUpdated](ctp:api:type:CustomerPasswordUpdatedMessage) Message with `reset=false`.  Returns a `200 OK` status if successful.

        A [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error is returned in the following scenarios:

        - If no Customer exists with the `id` specified in the [customer:{id}](/scopes#composable-commerce-oauth) scope.
        - If the Customer exists but is associated with a different Store than what is specified in the `manage_my_profile:{projectKey}:{storeKey}` scope.

      is:
        - conflicting
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_my_profile:{projectKey}',
                  'manage_my_profile:{projectKey}:{storeKey}',
                  'customer_id:{id}',
                ],
            },
        ]
      body:
        application/json:
          example: !include ../examples/Customer/MyCustomerChangePassword.json
          type: MyCustomerChangePassword
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/customer.example.json
              type: Customer
    /reset:
      type: base
      post:
        displayName: Reset password of My Customer in Store
        description: |
          This is the last step in the [password reset process of the authenticated Customer](/../api/projects/customers#password-reset-of-customer-in-store).

          Resetting a password produces the Customer [CustomerPasswordUpdated](ctp:api:type:CustomerPasswordUpdatedMessage) Message with `reset=true`.

          After the password is reset, all password tokens issued previously through the [password reset flow](/../api/projects/customers#password-reset-of-customer) are invalidated. In addition, any access and refresh tokens issued previously through the [password flow](/../api/authorization#password-flow) and [refresh token flow](/../api/authorization#refresh-token-flow) are invalidated. This invalidation of tokens is [eventually consistent](/../api/general-concepts#eventual-consistency).

          A [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error is returned in the following scenarios:

          - If no Customer exists with the `id` specified in the [customer:{id}](/scopes#composable-commerce-oauth) scope.
          - If the Customer exists but is associated with a different Store than what is specified in the `manage_my_profile:{projectKey}:{storeKey}` scope.
        securedBy:
          [
            oauth_2_0:
              {
                scopes:
                  [
                    'manage_my_profile:{projectKey}',
                    'manage_my_profile:{projectKey}:{storeKey}',
                    'customer_id:{id}',
                  ],
              },
          ]
        body:
          application/json:
            example: !include ../examples/Customer/CustomerResetPassword.json
            type: MyCustomerResetPassword
        responses:
          200:
            body:
              application/json:
                example: !include ../examples/customer.example.json
                type: Customer
          400:
            description: An [ExpiredCustomerPasswordToken](ctp:api:type:ExpiredCustomerPasswordTokenError) error is returned as the provided token has expired.
          404:
            description: The provided token is invalid or does not exist.
  /signup:
    type: base
    post:
      displayName: Create (sign up) My Customer in Store
      description: |

        If used with an optional [access token for an anonymous session](ctp:api:type:AnonymousSession), all Orders and Carts that belong to the `anonymousId` are assigned to the newly created Customer.

        If omitted in the request body, the [Customer](ctp:api:type:Customer) `stores` field is set to the [Store](ctp:api:type:Store) specified in the path parameter.

        A Cart returned in the [CustomerSignInResult](ctp:api:type:CustomerSignInResult) has any invalid Line Items removed and is [updated](/api/carts-orders-overview#cart-updates) with the latest prices, taxes, and discounts. During these updates, the following errors can be returned: [MatchingPriceNotFound](ctp:api:type:MatchingPriceNotFoundError) and [MissingTaxRateForCountry](ctp:api:type:MissingTaxRateForCountryError).

        Creating a Customer produces the [CustomerCreated](ctp:api:type:CustomerCreatedMessage) Message.
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_my_profile:{projectKey}',
                  'manage_my_profile:{projectKey}:{storeKey}',
                  'anonymous_id:{id}',
                ],
            },
        ]
      body:
        application/json:
          example: !include ../examples/customer-create.example.json
          type: MyCustomerDraft
      responses:
        201:
          body:
            application/json:
              example: !include ../examples/customer-sign-in-result.example.json
              type: CustomerSignInResult
  /login:
    type: base
    post:
      displayName: Authenticate (sign in) My Customer in Store
      description: |

        Retrieves the authenticated Customer (that matches the given email/password pair) if they are part of a specific [Store](ctp:api:type:Store).

        If used with an optional [access token for an anonymous session](ctp:api:type:AnonymousSession), all Orders and Carts that belong to the `anonymousId` are assigned to the newly logged-in Customer.

        - If the Customer does not have a Cart, the most recently modified anonymous cart becomes the Customer's Cart.
        - If the Customer already has a Cart, the most recently modified anonymous cart is handled according to [AnonymousCartSignInMode](ctp:api:type:AnonymousCartSignInMode).

        A Cart returned in the [CustomerSignInResult](ctp:api:type:CustomerSignInResult) has any invalid Line Items removed and is [updated](/api/carts-orders-overview#cart-updates) with the latest prices, taxes, and discounts. During these updates, the following errors can be returned: [MatchingPriceNotFound](ctp:api:type:MatchingPriceNotFoundError) and [MissingTaxRateForCountry](ctp:api:type:MissingTaxRateForCountryError).

        If an account with the given credentials is not found, an [InvalidCredentials](ctp:api:type:InvalidCredentialsError) error is returned.

      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_my_profile:{projectKey}',
                  'manage_my_profile:{projectKey}:{storeKey}',
                  'anonymous_id:{id}',
                ],
            },
        ]
      body:
        application/json:
          type: MyCustomerSignin
          example: !include ../examples/Customer/MyCustomerSignIn.json
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/customer-sign-in-result.example.json
              type: CustomerSignInResult
/customers:
  type:
    baseDomain:
      resourceType: Customer
      resourceQueryType: CustomerPagedQueryResponse
      resourceDraft: CustomerDraft
      whereExample: 'email = "email@example.com"'
      sortExample: createdAt asc
  (updateable): Customer
  (deleteable): Customer
  (createable): CustomerDraft
  description: |
    A Customer is a person purchasing products. Carts, Orders,
    Comments and Reviews can be associated to a Customer.
  get:
    displayName: Query Customers in Store
    securedBy:
      - oauth_2_0:
          scopes:
            - 'view_customers:{projectKey}'
            - 'view_customers:{projectKey}:{storeKey}'
    responses:
      200:
        body:
          application/json:
            example: !include ../examples/customers.example.json
  head:
    displayName: Check if Customers exist in Store by Query Predicate
    securedBy:
      - oauth_2_0:
          scopes:
            - 'view_customers:{projectKey}'
            - 'view_customers:{projectKey}:{storeKey}'
    description: Checks if one or more Customers exist for the provided query predicate. Returns a `200 OK` status if any Customers match the query predicate, or [Not Found](/../api/errors#404-not-found) otherwise.
    queryParameters:
      where?:
        type: QueryPredicate[]
  post:
    displayName: Create (sign up) Customer in Store
    securedBy:
      - oauth_2_0:
          scopes:
            - 'manage_customers:{projectKey}'
            - 'manage_customers:{projectKey}:{storeKey}'
    description: |
      When using this endpoint, if omitted, the Customer `stores` field is set to the [Store](ctp:api:type:Store) specified in the path parameter.

      If the `anonymousCart` field is set on the [CustomerDraft](ctp:api:type:CustomerDraft), then the newly created Customer will be assigned to that [Cart](ctp:api:type:Cart).
      Similarly, if the `anonymousId` field is set, the Customer will be set on all [Carts](ctp:api:type:Cart), [Orders](ctp:api:type:Order), [ShoppingLists](ctp:api:type:ShoppingList) and [Payments](ctp:api:type:Payment) with the same `anonymousId`.
      If a Cart with a `store` field specified, the `store` field must reference the same [Store](ctp:api:type:Store) specified in the `{storeKey}` path parameter.

      Creating a Customer produces the [CustomerCreated](ctp:api:type:CustomerCreatedMessage) Message. Simultaneously creating two Customers with the same email address can return a [LockedField](ctp:api:type:LockedFieldError) error.
    body:
      application/json:
        example: !include ../examples/customer-create.example.json
    responses:
      201:
        body:
          application/json:
            example: !include ../examples/customer-sign-in-result.example.json
            type: CustomerSignInResult
  /password-token={passwordToken}:
    (methodName): withPasswordToken
    type:
      baseResource:
        uriParameterName: passwordToken
        resourceType: Customer
    get:
      displayName: Get Customer in Store by password token
      description: |
        Use this method to retrieve a Store-specific Customer's details by using the password reset token during their [password reset process](/../api/customers-overview#customer-password-reset).

        If the Customer exists in the Project but the `stores` field references a different Store, this method returns a [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error.
      securedBy:
        - oauth_2_0:
            scopes:
              - 'view_customers:{projectKey}'
              - 'view_customers:{projectKey}:{storeKey}'
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/customer.example.json
        400:
          description: An [ExpiredCustomerPasswordToken](ctp:api:type:ExpiredCustomerPasswordTokenError) error is returned as the provided token has expired.
        404:
          description: The provided token is invalid or does not exist.
  /email-token={emailToken}:
    (methodName): withEmailToken
    type:
      baseResource:
        uriParameterName: emailToken
        resourceType: Customer
    get:
      displayName: Get Customer in Store by email token
      description: |
        Use this method to retrieve a Store-specific Customer's details by using the email token during their [email verification process](/../api/customers-overview#customer-email-verification).

        If the Customer exists in the Project but the `stores` field references a different [Store](ctp:api:type:Store), this method returns a [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error.
      securedBy:
        - oauth_2_0:
            scopes:
              - 'view_customers:{projectKey}'
              - 'view_customers:{projectKey}:{storeKey}'
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/customer.example.json
        400:
          description: An [ExpiredCustomerEmailToken](ctp:api:type:ExpiredCustomerEmailTokenError) error is returned as the provided token has expired.
        404:
          description: The provided token is invalid or does not exist.
  /email-token:
    type: base
    post:
      displayName: Create email token for Customer in Store
      description: |
        Use this method to create an email token for a Store-specific Customer during their [email verification process](/../api/customers-overview#customer-email-verification).

        If the Customer exists in the Project but the `stores` field references a different Store, this method returns a [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error.

        Creating an email token for the Customer produces the [CustomerEmailTokenCreated](ctp:api:type:CustomerEmailTokenCreatedMessage) Message.
        The Message will include the token's value, if the token's validity is 60 minutes or less.
      securedBy:
        - oauth_2_0:
            scopes:
              - 'manage_customers:{projectKey}'
              - 'manage_customers:{projectKey}:{storeKey}'
      body:
        application/json:
          example: !include ../examples/Customer/CustomerCreateEmailToken.json
          type: CustomerCreateEmailToken
      responses:
        200:
          body:
            application/json:
              type: CustomerToken
  /email/confirm:
    type: base
    post:
      displayName: Verify email of Customer in Store
      description: |
        Use this method to verify a Store-specific Customer's email during their [email verification process](/../api/customers-overview#customer-email-verification).

        Verifying the email of the Customer produces the [CustomerEmailVerified](ctp:api:type:CustomerEmailVerifiedMessage) Message.

        If the Customer exists in the Project but the `stores` field references a different [Store](ctp:api:type:Store), this method returns a [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error.

        After the email is verified, all email tokens issued previously through the [email verification flow](/../api/projects/customers#email-verification-of-customer) are invalidated. This invalidation of tokens is [eventually consistent](/../api/general-concepts#eventual-consistency).
      securedBy:
        - oauth_2_0:
            scopes:
              - 'manage_customers:{projectKey}'
              - 'manage_customers:{projectKey}:{storeKey}'
      body:
        application/json:
          example: !include ../examples/Customer/CustomerEmailVerify.json
          type: CustomerEmailVerify
      responses:
        200:
          description: The email was verified.
          body:
            application/json:
              example: !include ../examples/customer.example.json
              type: Customer
        400:
          description: An [ExpiredCustomerEmailToken](ctp:api:type:ExpiredCustomerEmailTokenError) error is returned as the provided token has expired.
        404:
          description: The provided token is invalid or does not exist.
  /password:
    type: base
    post:
      displayName: Change password of Customer in Store
      description: |
        Changing the password of the Customer produces the [CustomerPasswordUpdated](ctp:api:type:CustomerPasswordUpdatedMessage) Message with `reset=false`.
      securedBy:
        - oauth_2_0:
            scopes:
              - 'manage_customers:{projectKey}'
              - 'manage_customers:{projectKey}:{storeKey}'
      body:
        application/json:
          example: !include ../examples/Customer/CustomerChangePassword.json
          type: CustomerChangePassword
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/customer.example.json
              type: Customer
  /password/reset:
    type: base
    post:
      displayName: Reset password of Customer in Store
      description: |
        Use this method to reset a Store-specific Customer's password during their [password reset process](/../api/customers-overview#customer-password-reset).

        Resetting the password of the Customer produces the [CustomerPasswordUpdated](ctp:api:type:CustomerPasswordUpdatedMessage) Message with `reset=true`.

        After the password is reset, all password tokens issued previously through the [password reset flow](/../api/projects/customers#password-reset-of-customer) are invalidated. In addition, any access and refresh tokens issued previously through the [password flow](/../api/authorization#password-flow) and [refresh token flow](/../api/authorization#refresh-token-flow) are invalidated. This invalidation of tokens is [eventually consistent](/../api/general-concepts#eventual-consistency).

        If the Customer exists in the Project but the `stores` field references a different [Store](ctp:api:type:Store), then this method returns a [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error.
      securedBy:
        - oauth_2_0:
            scopes:
              - 'manage_customers:{projectKey}'
              - 'manage_customers:{projectKey}:{storeKey}'
      body:
        application/json:
          example: !include ../examples/Customer/CustomerResetPassword.json
          type: CustomerResetPassword
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/customer.example.json
              type: Customer
        400:
          description: An [ExpiredCustomerPasswordToken](ctp:api:type:ExpiredCustomerPasswordTokenError) error is returned as the provided token has expired.
        404:
          description: The provided token is invalid or does not exist.
  /password-token:
    type: base
    post:
      displayName: Create password reset token for Customer in Store
      description: |
        Use this method to create a password reset token for a Store-specific Customer during their [password reset process](/../api/customers-overview#customer-password-reset).

        If the Customer exists in the Project but the `stores` field references a different Store, this method returns a [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error.

        Creating a password reset token for the Customer produces the [CustomerPasswordTokenCreated](ctp:api:type:CustomerPasswordTokenCreatedMessage) Message.
        The Message will include the token's value, if the token's validity is 60 minutes or less.
      securedBy:
        - oauth_2_0:
            scopes:
              - 'manage_customers:{projectKey}'
              - 'manage_customers:{projectKey}:{storeKey}'
      body:
        application/json:
          type: CustomerCreatePasswordResetToken
          example: !include ../examples/Customer/CustomerCreatePasswordResetToken.json
      responses:
        200:
          body:
            application/json:
              type: CustomerToken
  /key={key}:
    (methodName): withKey
    type:
      baseResource:
        uriParameterName: key
        resourceType: Customer
        resourceUpdateType: CustomerUpdate
    get:
      displayName: Get Customer in Store by Key
      description: |
        If the Customer exists in the Project but the `stores` field references a different [Store](ctp:api:type:Store), this method returns a [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error.
      securedBy:
        - oauth_2_0:
            scopes:
              - 'view_customers:{projectKey}'
              - 'view_customers:{projectKey}:{storeKey}'
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/customer.example.json
    head:
      displayName: Check if Customer exists in Store by Key
      securedBy:
        - oauth_2_0:
            scopes:
              - 'view_customers:{projectKey}'
              - 'view_customers:{projectKey}:{storeKey}'
      description: Checks if a Customer exists with the provided `key`. Returns a `200 OK` status if the Customer exists or a `404 Not Found` otherwise.
    post:
      displayName: Update Customer in Store by Key
      description: |
        If the Customer exists in the Project but the `stores` field references a different Store, this method returns a [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error.

        Simultaneously updating two Customers with the same email address can return a [LockedField](ctp:api:type:LockedFieldError) error.
      securedBy:
        - oauth_2_0:
            scopes:
              - 'manage_customers:{projectKey}'
              - 'manage_customers:{projectKey}:{storeKey}'
      body:
        application/json:
          example: !include ../examples/customer-update.example.json
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/customer.example.json
    delete:
      displayName: Delete Customer in Store by Key
      description: |
        Deleting a Customer produces the [CustomerDeleted](ctp:api:type:CustomerDeletedMessage) Message.

        If the Customer exists in the Project but the `stores` field references a different [Store](ctp:api:type:Store), this method returns a [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error.
      is:
        - dataErasure
      securedBy:
        - oauth_2_0:
            scopes:
              - 'manage_customers:{projectKey}'
              - 'manage_customers:{projectKey}:{storeKey}'
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/customer.example.json
  /{ID}:
    (methodName): withId
    type:
      baseResource:
        uriParameterName: ID
        resourceType: Customer
        resourceUpdateType: CustomerUpdate
    get:
      displayName: Get Customer in Store by ID
      description: |
        If the Customer exists in the Project but the `stores` field references a different Store, this method returns a [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error.
      securedBy:
        - oauth_2_0:
            scopes:
              - 'view_customers:{projectKey}'
              - 'view_customers:{projectKey}:{storeKey}'
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/customer.example.json
    head:
      displayName: Check if Customer exists in Store by ID
      securedBy:
        - oauth_2_0:
            scopes:
              - 'view_customers:{projectKey}'
              - 'view_customers:{projectKey}:{storeKey}'
      description: Checks if a Customer exists with the provided `id`. Returns a `200 OK` status if the Customer exists or a `404 Not Found` otherwise.
    post:
      displayName: Update Customer in Store by ID
      description: |
        If the Customer exists in the Project but the `stores` field references a different [Store](ctp:api:type:Store), this method returns a [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error.

        Simultaneously updating two Customers with the same email address can return a [LockedField](ctp:api:type:LockedFieldError) error.

      securedBy:
        - oauth_2_0:
            scopes:
              - 'manage_customers:{projectKey}'
              - 'manage_customers:{projectKey}:{storeKey}'
      body:
        application/json:
          example: !include ../examples/customer-update.example.json
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/customer.example.json
    delete:
      displayName: Delete Customer in Store by ID
      description: |
        Deleting a Customer produces the [CustomerDeleted](ctp:api:type:CustomerDeletedMessage) Message.

        If the Customer exists in the Project but the `stores` field references a different Store, this method returns a [ResourceNotFound](ctp:api:type:ResourceNotFoundError) error.
      is:
        - dataErasure
      securedBy:
        - oauth_2_0:
            scopes:
              - 'manage_customers:{projectKey}'
              - 'manage_customers:{projectKey}:{storeKey}'
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/customer.example.json
/login:
  type: base
  description: Retrieves the authenticated customer.
  post:
    displayName: Authenticate (sign in) Customer in Store
    description: |
      Authenticates a Customer associated with a [Store](ctp:api:type:Store). For more information, see [Global versus Store-specific Customers](/../api/customers-overview#global-versus-store-specific-customers).

      A Cart returned in the [CustomerSignInResult](ctp:api:type:CustomerSignInResult) has any invalid Line Items removed and is [updated](/api/carts-orders-overview#cart-updates) with the latest prices, taxes, and discounts. During these updates, the following errors can be returned: [MatchingPriceNotFound](ctp:api:type:MatchingPriceNotFoundError) and [MissingTaxRateForCountry](ctp:api:type:MissingTaxRateForCountryError).

      Triggers [Cart merge during sign-in](/../api/customers-overview#cart-merge-during-sign-in).

      If the Customer exists in the Project but the `stores` field references a different [Store](ctp:api:type:Store), this method returns an [InvalidCredentials](ctp:api:type:InvalidCredentialsError) error.

    securedBy:
      - oauth_2_0:
          scopes:
            - 'manage_customers:{projectKey}'
            - 'manage_customers:{projectKey}:{storeKey}'
    body:
      application/json:
        type: CustomerSignin
        example: !include ../examples/Customer/CustomerSignIn.json
    responses:
      200:
        body:
          application/json:
            example: !include ../examples/customer-sign-in-result.example.json
            type: CustomerSignInResult
/shipping-methods:
  /matching-cart:
    type: base
    description: Get ShippingMethods for a cart in a store
    get:
      displayName: Get matching ShippingMethods for a Cart in Store
      description: |
        Retrieves the active ShippingMethods that can ship to the shipping address of the given Cart in a given [Store](ctp:api:type:Store).
        Each ShippingMethod contains exactly one ShippingRate with the flag `isMatching` set to `true`.
        This ShippingRate is used when the ShippingMethod is [added to the Cart](ctp:api:type:CartSetShippingMethodAction).
        If a matching ShippingMethod has `isDefault` set to `true`, it is returned as the first item in the array.
      is:
        - expandable
      securedBy:
        - oauth_2_0:
            scopes:
              - 'view_orders:{projectKey}'
              - 'view_orders:{projectKey}:{storeKey}'
              - 'manage_customers:{projectKey}:{storeKey}'
              - 'view_shipping_methods:{projectKey}'
              - 'manage_my_orders:{projectKey}'
              - 'manage_my_orders:{projectKey}:{storeKey}'
      queryParameters:
        cartId:
          type: string
          description: |
            ID of the Cart with a shipping address set.
      responses:
        200:
          body:
            application/json:
              type: ShippingMethodPagedQueryResponse
              example: !include ../examples/shipping-methods.example.json
    head:
      displayName: Check if matching ShippingMethod exists for a Cart in Store
      securedBy:
        - oauth_2_0:
            scopes:
              - 'view_orders:{projectKey}'
              - 'view_orders:{projectKey}:{storeKey}'
              - 'manage_customers:{projectKey}:{storeKey}'
              - 'view_shipping_methods:{projectKey}'
              - 'manage_my_orders:{projectKey}'
              - 'manage_my_orders:{projectKey}:{storeKey}'
      queryParameters:
        cartId:
          type: string
          description: |
            ID of the Cart with a shipping address set.
      description: Checks if an active ShippingMethod that can ship to the shipping address of the given Cart exists in the given [Store](ctp:api:type:Store). Returns a `200 OK` status if the ShippingMethod exists or a `404 Not Found` otherwise.
/shopping-lists:
  type:
    baseDomain:
      resourceType: ShoppingList
      resourceQueryType: ShoppingListPagedQueryResponse
      resourceDraft: ShoppingListDraft
      whereExample: 'key = "my-shopping-list"'
      sortExample: createdAt asc
  description: |
    shopping-lists e.g. for wishlist support
  get:
    displayName: Query ShoppingLists in Store
    description: Retrieves ShoppingLists in a [Store](ctp:api:type:Store).
    securedBy:
      [
        oauth_2_0:
          {
            scopes:
              [
                'view_shopping_lists:{projectKey}',
                'view_shopping_lists:{projectKey}:{storeKey}',
              ],
          },
      ]
    queryParameters:
      expand:
        description: |
          *Limitation: `expand=lineItems[0].variant` and `expand=lineItems[0].productSlug` are not supported.*
        type: Expansion[]
        required: false
    responses:
      200:
        body:
          application/json:
            example: !include ../examples/shopping-lists.example.json
  head:
    displayName: Check if ShoppingList exists in Store by Query Predicate
    securedBy:
      [
        oauth_2_0:
          {
            scopes:
              [
                'view_shopping_lists:{projectKey}',
                'view_shopping_lists:{projectKey}:{storeKey}',
              ],
          },
      ]
    description: Checks if one or more ShoppingLists exist for the provided query predicate in a [Store](ctp:api:type:Store). Returns a `200 OK` status if any ShoppingLists match the query predicate or [Not Found](/../api/errors#404-not-found) otherwise.
    queryParameters:
      where?:
        type: QueryPredicate[]
  post:
    displayName: Create ShoppingList in Store
    securedBy:
      [
        oauth_2_0:
          {
            scopes:
              [
                'manage_shopping_lists:{projectKey}',
                'manage_shopping_lists:{projectKey}:{storeKey}',
              ],
          },
      ]
    queryParameters:
      expand:
        description: |
          *Limitation: `expand=lineItems[0].variant` and `expand=lineItems[0].productSlug` are not supported.*
        type: Expansion[]
        required: false
    body:
      application/json:
        example: !include ../examples/shopping-list-create.example.json
    description: |
      Creates a ShoppingList in a [Store](ctp:api:type:Store).
      When using this endpoint, the `store` field of a ShoppingList is always set to the [Store](ctp:api:type:Store) specified in the path parameter.
    responses:
      201:
        body:
          application/json:
            example: !include ../examples/shopping-list.example.json
  /key={key}:
    (methodName): withKey
    type:
      baseResource:
        uriParameterName: key
        resourceType: ShoppingList
        resourceUpdateType: ShoppingListUpdate
    get:
      displayName: Get ShoppingList in Store by Key
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_shopping_lists:{projectKey}',
                  'view_shopping_lists:{projectKey}:{storeKey}',
                ],
            },
        ]
      queryParameters:
        expand:
          description: |
            When expanding `variant` and `productSlug` on [ShoppingListLineItem](ctp:api:type:ShoppingListLineItem), [expand the entire array](/general-concepts#reference-expansion). You cannot expand a single element (for example, `expand=lineItems[0].variant` is not supported).
          type: Expansion[]
          required: false
      description: |
        Retrieves a ShoppingList with the provided `key` in a [Store](ctp:api:type:Store).
        If a ShoppingList exists in a Project but does _not_ have the `store` field, or the `store` field references a different Store,
        the [ResourceNotFound](/errors#404-not-found-1) error is returned.
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/shopping-list.example.json
    head:
      displayName: Check if ShoppingList exists in Store by Key
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_shopping_lists:{projectKey}',
                  'view_shopping_lists:{projectKey}:{storeKey}',
                ],
            },
        ]
      description: Checks if a ShoppingList exists with the provided `key` in a [Store](ctp:api:type:Store). Returns a `200 OK` status if the ShoppingList exists or [Not Found](/../api/errors#404-not-found) otherwise.
    post:
      displayName: Update ShoppingList in Store by Key
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_shopping_lists:{projectKey}',
                  'manage_shopping_lists:{projectKey}:{storeKey}',
                ],
            },
        ]
      queryParameters:
        expand:
          description: |
            When expanding `variant` and `productSlug` on [ShoppingListLineItem](ctp:api:type:ShoppingListLineItem), [expand the entire array](/general-concepts#reference-expansion). You cannot expand a single element (for example, `expand=lineItems[0].variant` is not supported).
          type: Expansion[]
          required: false
      description: |
        Updates a ShoppingList in a [Store](ctp:api:type:Store) using one or more [update actions](/../api/projects/shoppingLists#update-actions).
        If a ShoppingList exists in a Project but does _not_ have the `store` field, or the `store` field references a different Store,
        the [ResourceNotFound](/errors#404-not-found-1) error is returned.
      body:
        application/json:
          example: !include ../examples/shopping-list-update.example.json
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/shopping-list.example.json
    delete:
      displayName: Delete ShoppingList in Store by Key
      is:
        - dataErasure
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_shopping_lists:{projectKey}',
                  'manage_shopping_lists:{projectKey}:{storeKey}',
                ],
            },
        ]
      queryParameters:
        expand:
          description: |
            When expanding `variant` and `productSlug` on [ShoppingListLineItem](ctp:api:type:ShoppingListLineItem), [expand the entire array](/general-concepts#reference-expansion). You cannot expand a single element (for example, `expand=lineItems[0].variant` is not supported).
          type: Expansion[]
          required: false
      description: |
        Deletes a ShoppingList in a [Store](ctp:api:type:Store).
        If a ShoppingList exists in a Project but does _not_ have the `store` field, or the `store` field references a different Store,
        the [ResourceNotFound](/errors#404-not-found-1) error is returned.
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/shopping-list.example.json
  /{ID}:
    (methodName): withId
    type:
      baseResource:
        uriParameterName: ID
        resourceType: ShoppingList
        resourceUpdateType: ShoppingListUpdate
    get:
      displayName: Get ShoppingList in Store by ID
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_shopping_lists:{projectKey}',
                  'view_shopping_lists:{projectKey}:{storeKey}',
                ],
            },
        ]
      queryParameters:
        expand:
          description: |
            When expanding `variant` and `productSlug` on [ShoppingListLineItem](ctp:api:type:ShoppingListLineItem), [expand the entire array](/general-concepts#reference-expansion). You cannot expand a single element (for example, `expand=lineItems[0].variant` is not supported).
          type: Expansion[]
          required: false
      description: |
        Retrieves a ShoppingList with the provided `id` in a [Store](ctp:api:type:Store).
        If a ShoppingList exists in a Project but does _not_ have the `store` field, or the `store` field references a different Store,
        the [ResourceNotFound](/errors#404-not-found-1) error is returned.
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/shopping-list.example.json
    head:
      displayName: Check if ShoppingList exists in Store by ID
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_shopping_lists:{projectKey}',
                  'view_shopping_lists:{projectKey}:{storeKey}',
                ],
            },
        ]
      description: Checks if a ShoppingList exists with the provided `id` in a [Store](ctp:api:type:Store). Returns a `200 OK` status if the ShoppingList exists or [Not Found](/../api/errors#404-not-found) otherwise.
    post:
      displayName: Update ShoppingList in Store by ID
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_shopping_lists:{projectKey}',
                  'manage_shopping_lists:{projectKey}:{storeKey}',
                ],
            },
        ]
      queryParameters:
        expand:
          description: |
            When expanding `variant` and `productSlug` on [ShoppingListLineItem](ctp:api:type:ShoppingListLineItem), [expand the entire array](/general-concepts#reference-expansion). You cannot expand a single element (for example, `expand=lineItems[0].variant` is not supported).
          type: Expansion[]
          required: false
      body:
        application/json:
          example: !include ../examples/shopping-list-update.example.json
      description: |
        Updates a ShoppingList in a [Store](ctp:api:type:Store) using one or more [update actions](/../api/projects/shoppingLists#update-actions).
        If a ShoppingList exists in a Project but does _not_ have the `store` field, or the `store` field references a different Store,
        the [ResourceNotFound](/errors#404-not-found-1) error is returned.
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/shopping-list.example.json
    delete:
      displayName: Delete ShoppingList in Store by ID
      is:
        - dataErasure
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_shopping_lists:{projectKey}',
                  'manage_shopping_lists:{projectKey}:{storeKey}',
                ],
            },
        ]
      queryParameters:
        expand:
          description: |
            When expanding `variant` and `productSlug` on [ShoppingListLineItem](ctp:api:type:ShoppingListLineItem), [expand the entire array](/general-concepts#reference-expansion). You cannot expand a single element (for example, `expand=lineItems[0].variant` is not supported).
          type: Expansion[]
          required: false
      description: |
        Deletes a ShoppingList in a [Store](ctp:api:type:Store).
        If a ShoppingList exists in a Project but does _not_ have the `store` field, or the `store` field references a different Store,
        the [ResourceNotFound](/errors#404-not-found-1) error is returned.
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/shopping-list.example.json
/product-projections:
  /key={key}:
    (methodName): withKey
    type:
      baseResource:
        uriParameterName: key
        resourceType: ProductProjection
    get:
      displayName: Gets the current or staged representation of a product by its key from a specific Store
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_products:{projectKey}',
                  'view_published_products:{projectKey}',
                ],
            },
        ]
      description: |
        Gets the current or staged representation of a [Product](ctp:api:type:Product) by its key in the specified [Store](ctp:api:type:Store).
        If the Store has defined some languages, countries, distribution, supply Channels, and/or Product Selection,
        they are used for projections based on [locale](ctp:api:type:ProductProjectionLocales), [price](ctp:api:type:ProductProjectionPrices),
        and [inventory](ctp:api:type:ProductProjectionInventoryEntries).

        If [ProductSelection](ctp:api:type:ProductSelection) is used, it affects the [availability of the Product](/projects/stores#products-available-in-store) in the specified Store.

        If a [ProductTailoring](ctp:api:type:ProductTailoring) exists for the Product with the given `key` and the given Store, this endpoint returns the ProductProjection with tailored data.

        When used with an API Client that has the `view_published_products:{projectKey}` scope, this endpoint only returns published (current) Product Projections.
      is:
        - projectionSelectingTailoring
        - priceSelecting
        - localeProjecting
    head:
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_products:{projectKey}',
                  'view_published_products:{projectKey}',
                ],
            },
        ]
      description: Checks if the current or staged representations of a Product exists with the provided `key` in the specified [Store](ctp:api:type:Store). Returns a `200 OK` status if the ProductProjection exists or a `404 Not Found` otherwise.
  /{ID}:
    (methodName): withId
    type:
      baseResource:
        uriParameterName: ID
        resourceType: ProductProjection
    get:
      displayName: Gets the current or staged representation of a product by its ID from a specific Store
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_products:{projectKey}',
                  'view_published_products:{projectKey}',
                ],
            },
        ]
      description: |
        Gets the current or staged representation of a [Product](ctp:api:type:Product) by its ID in the specified [Store](ctp:api:type:Store).
        If the Store has defined some languages, countries, distribution, supply Channels, and/or Product Selection,
        they are used for projections based on [locale](ctp:api:type:ProductProjectionLocales), [price](ctp:api:type:ProductProjectionPrices),
        and [inventory](ctp:api:type:ProductProjectionInventoryEntries).

        If [ProductSelection](ctp:api:type:ProductSelection) is used, it affects the [availability of the Product](/projects/stores#products-available-in-store) in the specified Store.

        If a [ProductTailoring](ctp:api:type:ProductTailoring) exists for the Product with the given `id` and the given Store, this endpoint returns the ProductProjection with tailored data.

        When used with an API Client that has the `view_published_products:{projectKey}` scope, this endpoint only returns published (current) Product Projections.
      is:
        - projectionSelectingTailoring
        - priceSelecting
        - localeProjecting
    head:
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_products:{projectKey}',
                  'view_published_products:{projectKey}',
                ],
            },
        ]
      description: Checks if the current or staged representations of a Product exists with the provided `id` in the specified [Store](ctp:api:type:Store). Returns a `200 OK` status if the ProductProjection exists or a `404 Not Found` otherwise.
/product-selection-assignments:
  type: base
  get:
    displayName: Query available products in store
    is:
      - expandable
      - query:
          whereExample: 'product(id in ("c89f4753-050d-44af-9411-0a941e745c6e"))'
    securedBy: [oauth_2_0: { scopes: ['view_product_selections:{projectKey}'] }]
    description: |
      Queries Product Selection assignments in a specific [Store](ctp:api:type:Store).

      The response will include duplicate Products whenever more than one active Product Selection of the Store
      includes a Product. To make clear through which Product Selection a Product is available in the Store
      the response contains assignments including both the Product and the Product Selection.
      Only Products of Product Selections that are activated in the Store will be returned.

    queryParameters:
      limit:
        type: number
        format: int32
        required: false
        description: |
          Number of [results requested](/../api/general-concepts#limit).
        default: 20
        minimum: 0
        maximum: 500
      offset:
        type: number
        format: int32
        required: false
        description: |
          Number of [elements skipped](/../api/general-concepts#offset).
        default: 0
        maximum: 10000
      withTotal:
        type: boolean
        default: false
        required: false
        description: |
          Controls the calculation of the [total](/../api/general-concepts#total) number of query results. Set to `true` to get the [total](/general-concepts#total) number of query results. This may impact query performance.
    responses:
      200:
        body:
          application/json:
            example: !include ../examples/products-in-store.example.json
            type: ProductsInStorePagedQueryResponse
/cart-discounts:
  type:
    baseDomain:
      resourceType: CartDiscount
      resourceQueryType: CartDiscountPagedQueryResponse
      resourceDraft: CartDiscountDraft
      whereExample: isActive = true
      sortExample: createdAt asc
  get:
    displayName: Query CartDiscounts in Store
    securedBy:
      [
        oauth_2_0:
          {
            scopes:
              [
                'view_orders:{projectKey}',
                'view_orders:{projectKey}:{storeKey}',
                'view_cart_discounts:{projectKey}',
                'view_cart_discounts:{projectKey}:{storeKey}',
              ],
          },
      ]
    responses:
      200:
        body:
          application/json:
            example: !include ../examples/cart-discounts.example.json
  head:
    displayName: Check if CartDiscount exists in Store by Query Predicate
    securedBy:
      [
        oauth_2_0:
          {
            scopes:
              [
                'view_orders:{projectKey}',
                'view_orders:{projectKey}:{storeKey}',
                'view_cart_discounts:{projectKey}',
                'view_cart_discounts:{projectKey}:{storeKey}',
              ],
          },
      ]
    description: Checks if one or more CartDiscounts exist for the provided query predicate. Returns a `200 OK` status if any CartDiscounts match the query predicate, or a `404 Not Found` otherwise.
    queryParameters:
      where?:
        type: QueryPredicate[]
  post:
    displayName: Create CartDiscount in Store
    description: |
      When using the endpoint, the Store specified in the path and the Stores specified in the payload's `stores` field are added to the CartDiscount.

      Creating a Cart Discount produces the [CartDiscountCreated](ctp:api:type:CartDiscountCreatedMessage) Message.
    securedBy:
      [
        oauth_2_0:
          {
            scopes:
              [
                'manage_orders:{projectKey}',
                'manage_orders:{projectKey}:{storeKey}',
                'manage_cart_discounts:{projectKey}',
                'manage_cart_discounts:{projectKey}:{storeKey}',
              ],
          },
      ]
    body:
      application/json:
        example: !include ../examples/cart-discount-create.example.json
    responses:
      201:
        body:
          application/json:
            example: !include ../examples/cart-discount.example.json
  /key={key}:
    (methodName): withKey
    type:
      baseResource:
        uriParameterName: key
        resourceType: CartDiscount
        resourceUpdateType: CartDiscountUpdate
    get:
      displayName: Get CartDiscount in Store by Key
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_orders:{projectKey}',
                  'view_orders:{projectKey}:{storeKey}',
                  'view_cart_discounts:{projectKey}',
                  'view_cart_discounts:{projectKey}:{storeKey}',
                ],
            },
        ]
      responses:
        200:
          body:
            application/json:
              type: CartDiscount
              example: !include ../examples/cart-discount.example.json
    head:
      displayName: Check if CartDiscount exists in Store by Key
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_orders:{projectKey}',
                  'view_orders:{projectKey}:{storeKey}',
                  'view_cart_discounts:{projectKey}',
                  'view_cart_discounts:{projectKey}:{storeKey}',
                ],
            },
        ]
      description: Checks if a CartDiscount exists with the provided `key`. Returns a `200 OK` status if the CartDiscount exists or a `404 Not Found` otherwise.
    post:
      displayName: Update CartDiscount in Store by Key
      description: |
        To update a CartDiscount, you must have permissions for all Stores the CartDiscount is associated with, except when [removing a Store](ctp:api:type:CartDiscountRemoveStoreAction).
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_orders:{projectKey}',
                  'manage_orders:{projectKey}:{storeKey}',
                  'manage_cart_discounts:{projectKey}',
                  'manage_cart_discounts:{projectKey}:{storeKey}',
                ],
            },
        ]
      body:
        application/json:
          example: !include ../examples/cart-discount-update.example.json
      responses:
        200:
          body:
            application/json:
              type: CartDiscount
              example: !include ../examples/cart-discount.example.json
    delete:
      displayName: Delete CartDiscount in Store by Key
      description: |
        To delete a CartDiscount, specify the `manage_cart_discounts:{projectKey}:{storeKey}` scope for all Stores associated with the CartDiscount.

        Deleting a Cart Discount produces the [CartDiscountDeleted](ctp:api:type:CartDiscountDeletedMessage) Message.
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_orders:{projectKey}',
                  'manage_orders:{projectKey}:{storeKey}',
                  'manage_cart_discounts:{projectKey}',
                  'manage_cart_discounts:{projectKey}:{storeKey}',
                ],
            },
        ]
      responses:
        200:
          body:
            application/json:
              type: CartDiscount
              example: !include ../examples/cart-discount.example.json
  /{ID}:
    (methodName): withId
    type:
      baseResource:
        uriParameterName: ID
        resourceType: CartDiscount
        resourceUpdateType: CartDiscountUpdate
    get:
      displayName: Get CartDiscount in Store by ID
      description: |
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_orders:{projectKey}',
                  'view_orders:{projectKey}:{storeKey}',
                  'view_cart_discounts:{projectKey}',
                  'view_cart_discounts:{projectKey}:{storeKey}',
                ],
            },
        ]
      responses:
        200:
          body:
            application/json:
              type: CartDiscount
              example: !include ../examples/cart-discount.example.json
    head:
      displayName: Check if CartDiscount exists in Store by ID
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_orders:{projectKey}',
                  'view_orders:{projectKey}:{storeKey}',
                  'view_cart_discounts:{projectKey}',
                  'view_cart_discounts:{projectKey}:{storeKey}',
                ],
            },
        ]
      description: Checks if a CartDiscount exists with the provided `id`. Returns a `200 OK` status if the CartDiscount exists or a `404 Not Found` otherwise.
    post:
      displayName: Update CartDiscount in Store by ID
      description: |
        To update a CartDiscount, you must have permissions for all Stores the CartDiscount is associated with, except when [removing a Store](ctp:api:type:CartDiscountRemoveStoreAction).
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_orders:{projectKey}',
                  'manage_orders:{projectKey}:{storeKey}',
                  'manage_cart_discounts:{projectKey}',
                  'manage_cart_discounts:{projectKey}:{storeKey}',
                ],
            },
        ]
      body:
        application/json:
          example: !include ../examples/cart-discount-update.example.json
      responses:
        200:
          body:
            application/json:
              type: CartDiscount
              example: !include ../examples/cart-discount.example.json
    delete:
      displayName: Delete CartDiscount in Store by ID
      description: |
        To delete a CartDiscount, specify the `manage_cart_discounts:{projectKey}:{storeKey}` scope for all Stores associated with the CartDiscount.

        Deleting a Cart Discount produces the [CartDiscountDeleted](ctp:api:type:CartDiscountDeletedMessage) Message.
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_orders:{projectKey}',
                  'manage_orders:{projectKey}:{storeKey}',
                  'manage_cart_discounts:{projectKey}',
                  'manage_cart_discounts:{projectKey}:{storeKey}',
                ],
            },
        ]
      responses:
        200:
          body:
            application/json:
              type: CartDiscount
              example: !include ../examples/cart-discount.example.json
/product-tailoring:
  type:
    baseDomain:
      resourceType: ProductTailoring
      resourceQueryType: ProductTailoringPagedQueryResponse
      resourceDraft: ProductTailoringInStoreDraft
      resourceUpdateType: ProductTailoringUpdate
      sortExample: createdAt asc
  (updateable): ProductTailoring
  (createable): ProductTailoringInStoreDraft
  description: A Product Tailoring holds tailored data of Product in the Store.
  get:
    displayName: Query available product tailoring in store
    is:
      - expandable
      - query:
          whereExample: 'product(id in ("c89f4753-050d-44af-9411-0a941e745c6e"))'
    securedBy: [oauth_2_0: { scopes: ['view_products:{projectKey}'] }]
    description: |
      Queries Product Tailoring in a specific [Store](ctp:api:type:Store).

    queryParameters:
      limit:
        type: number
        format: int32
        required: false
        description: |
          Number of [results requested](/../api/general-concepts#limit).
        default: 20
        minimum: 0
        maximum: 500
      offset:
        type: number
        format: int32
        required: false
        description: |
          Number of [elements skipped](/../api/general-concepts#offset).
        default: 0
        maximum: 10000
      withTotal:
        type: boolean
        default: false
        required: false
        description: |
          Controls the calculation of the [total](/../api/general-concepts#total) number of query results. Set to `true` to get the [total](/general-concepts#total) number of query results. This may impact query performance.
    responses:
      200:
        body:
          application/json:
            example: !include ../examples/product-tailoring-list.example.json
            type: ProductTailoringPagedQueryResponse
  post:
    displayName: Create Product Tailoring in store
    securedBy:
      [
        oauth_2_0:
          {
            scopes:
              [
                'manage_products:{projectKey}',
                'manage_products:{projectKey}:{storeKey}',
              ],
          },
      ]
    description: |
      Creates a [ProductTailoring](ctp:api:type:ProductTailoring) in the [Store](ctp:api:type:Store) specified by `storeKey`.
      When using this endpoint the ProductTailoring's `store` field is always set to the [Store](ctp:api:type:Store) specified in the path parameter.

      Generates the [ProductTailoringCreated](ctp:api:type:ProductTailoringCreatedMessage) Message.
    body:
      application/json:
        example: !include ../examples/product-tailoring-in-store-create.example.json
    responses:
      201:
        body:
          application/json:
            example: !include ../examples/product-tailoring.example.json

/products:
  /{productID}:
    (methodName): withProductId
    uriParameters:
      productID:
        type: string
        description: |
          `id` of the [Product](ctp:api:type:Product).
    /product-tailoring:
      type:
        baseSubResource:
          resourceType: ProductTailoring
          resourceUpdateType: ProductTailoringUpdate
      get:
        displayName: Gets the current or staged representation of a Product Tailoring by its Product ID from a specific Store
        securedBy:
          [
            oauth_2_0:
              {
                scopes:
                  [
                    'view_products:{projectKey}',
                    'view_products:{projectKey}:{storeKey}',
                  ],
              },
          ]
        description: |
          Gets the current or staged representation of a [Product Tailoring](ctp:api:type:ProductTailoring) by its Product ID in the specified [Store](ctp:api:type:Store).
        responses:
          200:
            body:
              application/json:
                example: !include ../examples/product-tailoring.example.json
                type: ProductTailoring
      post:
        displayName: Update a Product Tailoring by its Product ID from a specific Store
        securedBy:
          [
            oauth_2_0:
              {
                scopes:
                  [
                    'manage_products:{projectKey}',
                    'manage_products:{projectKey}:{storeKey}',
                  ],
              },
          ]
        description: |
          Updates the current or staged representation of a [Product Tailoring](ctp:api:type:ProductTailoring) by its Product ID in the specified [Store](ctp:api:type:Store).
        body:
          application/json:
            example: !include ../examples/product-tailoring-update.example.json
        responses:
          200:
            body:
              application/json:
                type: ProductTailoring
                example: !include ../examples/product-tailoring-updated.example.json
      delete:
        displayName: Delete a Product Tailoring by its Product ID from a specific Store
        description: |
          Generates the [ProductTailoringDeleted](ctp:api:type:ProductTailoringDeletedMessage) Message.
        securedBy:
          [
            oauth_2_0:
              {
                scopes:
                  [
                    'manage_products:{projectKey}',
                    'manage_products:{projectKey}:{storeKey}',
                  ],
              },
          ]
        responses:
          200:
            body:
              application/json:
                type: ProductTailoring
                example: !include ../examples/product-tailoring.example.json
      /images:
        post:
          displayName: Upload a Product Tailoring image
          description: |
            Uploads a JPEG, PNG and GIF file to a [ProductVariantTailoring](ctp:api:type:ProductVariantTailoring).
            The maximum file size of the image is **10MB**.
            Either `variant` or `sku` is required to update a specific ProductVariant.
            If neither is provided, the image is uploaded to the Master Variant of the Product.

            The response status code depends on the size of the original image.
            If the image is small, the API responds with `200 OK`, and if the image is larger, it responds with `202 Accepted`.
            The Product returned with a `202 Accepted` status code contains a `warnings` field with an [ImageProcessingOngoing](ctp:api:type:ImageProcessingOngoingWarning) Warning.

            Produces the [ProductTailoringImageAdded](/projects/messages/product-catalog-messages#product-tailoring-image-added) Message.
          queryParameters:
            filename?:
              type: string
              default: 'img'
              description: |
                URL-encoded filename of the image when stored in the Content Delivery Network (CDN).
                The filename is modified when uploaded to prevent filename conflicts.
                If not provided, a random filename is generated.
            variant?:
              type: number
              format: int64
              description: |
                The `id` of the [ProductVariantTailoring](/projects/product-tailoring#productvarianttailoring) the image should be uploaded to.
                It must correspond to an existing [ProductVariant](/projects/products#productvariant) in the Product.
            sku?:
              type: string
              description: |
                The `sku` of the [ProductVariantTailoring](/projects/product-tailoring#productvarianttailoring) the image should be uploaded to.
                It must correspond to an existing [ProductVariant](/projects/products#productvariant) in the Product.
            staged?:
              type: boolean
              default: true
              description: |
                If `true`, only the staged ProductVariantTailoring is updated.
                If `false`, both the current and staged ProductVariantTailoring are updated.
          securedBy: [oauth_2_0: { scopes: ['manage_products:{projectKey}'] }]
          body:
            image/jpeg:
              type: file
            image/png:
              type: file
            image/gif:
              type: file
          headers:
            Content-Type:
              type: string
              description: |
                One of `image/jpeg`, `image/png`, or `image/gif`.
          responses:
            200:
              body:
                application/json:
                  type: ProductTailoring
                  example: !include ../examples/product-tailoring.example.json
            202:
              body:
                application/json:
                  type: ProductTailoring
                  example: !include ../examples/product-tailoring-with-image-processing-warning.example.json
  /key={productKey}:
    (methodName): withProductKey
    uriParameters:
      productKey:
        type: string
        description: |
          `key` of the [Product](ctp:api:type:Product).
    /product-tailoring:
      type:
        baseSubResource:
          resourceType: ProductTailoring
          resourceUpdateType: ProductTailoringUpdate
      get:
        displayName: Gets the current or staged representation of a Product Tailoring by its Product key from a specific Store
        securedBy:
          [
            oauth_2_0:
              {
                scopes:
                  [
                    'view_products:{projectKey}',
                    'view_products:{projectKey}:{storeKey}',
                  ],
              },
          ]
        description: |
          Gets the current or staged representation of a [Product Tailoring](ctp:api:type:ProductTailoring) by its Product key in the specified [Store](ctp:api:type:Store).
        responses:
          200:
            body:
              application/json:
                example: !include ../examples/product-tailoring.example.json
                type: ProductTailoring
      post:
        displayName: Update a Product Tailoring by its Product key from a specific Store
        securedBy:
          [
            oauth_2_0:
              {
                scopes:
                  [
                    'manage_products:{projectKey}',
                    'manage_products:{projectKey}:{storeKey}',
                  ],
              },
          ]
        description: |
          Updates the current or staged representation of a [Product Tailoring](ctp:api:type:ProductTailoring) by its Product key in the specified [Store](ctp:api:type:Store).
        body:
          application/json:
            example: !include ../examples/product-tailoring-update.example.json
        responses:
          200:
            body:
              application/json:
                type: ProductTailoring
                example: !include ../examples/product-tailoring-updated.example.json
      delete:
        displayName: Delete a Product Tailoring by its Product key from a specific Store
        description: |
          Generates the [ProductTailoringDeleted](ctp:api:type:ProductTailoringDeletedMessage) Message.
        securedBy:
          [
            oauth_2_0:
              {
                scopes:
                  [
                    'manage_products:{projectKey}',
                    'manage_products:{projectKey}:{storeKey}',
                  ],
              },
          ]
        responses:
          200:
            body:
              application/json:
                type: ProductTailoring
                example: !include ../examples/product-tailoring.example.json
      /images:
        post:
          displayName: Upload a Product Tailoring image
          description: |
            Uploads a JPEG, PNG and GIF file to a [ProductVariantTailoring](ctp:api:type:ProductVariantTailoring).
            The maximum file size of the image is **10MB**.
            Either `variant` or `sku` is required to update a specific ProductVariant.
            If neither is provided, the image is uploaded to the Master Variant of the Product.

            The response status code depends on the size of the original image.
            If the image is small, the API responds with `200 OK`, and if the image is larger, it responds with `202 Accepted`.
            The Product returned with a `202 Accepted` status code contains a `warnings` field with an [ImageProcessingOngoing](ctp:api:type:ImageProcessingOngoingWarning) Warning.

            Produces the [ProductTailoringImageAdded](/projects/messages/product-catalog-messages#product-tailoring-image-added) Message.
          queryParameters:
            filename?:
              type: string
              default: 'img'
              description: |
                URL-encoded filename of the image when stored in the Content Delivery Network (CDN).
                The filename is modified when uploaded to prevent filename conflicts.
                If not provided, a random filename is generated.
            variant?:
              type: number
              format: int64
              description: |
                The `id` of the [ProductVariantTailoring](/projects/product-tailoring#productvarianttailoring) the image should be uploaded to.
                It must correspond to an existing [ProductVariant](/projects/products#productvariant) in the Product.
            sku?:
              type: string
              description: |
                The `sku` of the [ProductVariantTailoring](/projects/product-tailoring#productvarianttailoring) the image should be uploaded to.
                It must correspond to an existing [ProductVariant](/projects/products#productvariant) in the Product.
            staged?:
              type: boolean
              default: true
              description: |
                If `true`, only the staged ProductVariantTailoring is updated.
                If `false`, both the current and staged ProductVariantTailoring are updated.
          securedBy: [oauth_2_0: { scopes: ['manage_products:{projectKey}'] }]
          body:
            image/jpeg:
              type: file
            image/png:
              type: file
            image/gif:
              type: file
          headers:
            Content-Type:
              type: string
              description: |
                One of `image/jpeg`, `image/png`, or `image/gif`.
          responses:
            200:
              body:
                application/json:
                  type: ProductTailoring
                  example: !include ../examples/product-tailoring.example.json
            202:
              body:
                application/json:
                  type: ProductTailoring
                  example: !include ../examples/product-tailoring-with-image-processing-warning.example.json
/quote-requests:
  type:
    baseDomain:
      resourceType: QuoteRequest
      resourceQueryType: QuoteRequestPagedQueryResponse
      resourceDraft: QuoteRequestDraft
      whereExample: 'quoteRequestState = "Submitted"'
      sortExample: createdAt asc
  (updateable): QuoteRequest
  (deleteable): QuoteRequest
  (createable): QuoteRequestDraft
  description: A request for a Quote holds product variants and can be ordered.
  get:
    displayName: Query QuoteRequests in Store
    securedBy:
      [
        oauth_2_0:
          {
            scopes:
              [
                'view_quote_requests:{projectKey}',
                'view_quote_requests:{projectKey}:{storeKey}',
              ],
          },
      ]
    responses:
      200:
        body:
          application/json:
            example: !include ../examples/quote-requests.example.json
  head:
    displayName: Check if QuoteRequest exists in Store by Query Predicate
    securedBy:
      [
        oauth_2_0:
          {
            scopes:
              [
                'view_quote_requests:{projectKey}',
                'view_quote_requests:{projectKey}:{storeKey}',
              ],
          },
      ]
    description: Checks if one or more QuoteRequests exist for the provided query predicate. Returns a `200 OK` status if any QuoteRequests match the query predicate, or [Not Found](/../api/errors#404-not-found) otherwise.
    queryParameters:
      where?:
        type: QueryPredicate[]
  post:
    displayName: Create QuoteRequest in Store
    description: |
    securedBy:
      [
        oauth_2_0:
          {
            scopes:
              [
                'manage_quote_requests:{projectKey}',
                'manage_quote_requests:{projectKey}:{storeKey}',
              ],
          },
      ]
    body:
      application/json:
        example: !include ../examples/quote-request-create.example.json
    responses:
      201:
        body:
          application/json:
            example: !include ../examples/quote-request.example.json
  /key={key}:
    (methodName): withKey
    type:
      baseResource:
        uriParameterName: key
        resourceType: QuoteRequest
        resourceUpdateType: QuoteRequestUpdate
    get:
      displayName: Get QuoteRequest in Store by Key
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_quote_requests:{projectKey}',
                  'view_quote_requests:{projectKey}:{storeKey}',
                ],
            },
        ]
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/quote-request.example.json
    head:
      displayName: Check if QuoteRequest exists in Store by Key
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_quote_requests:{projectKey}',
                  'view_quote_requests:{projectKey}:{storeKey}',
                ],
            },
        ]
      description: Checks if a QuoteRequest exists with the provided `key`. Returns a `200 OK` status if the QuoteRequest exists or [Not Found](/../api/errors#404-not-found) otherwise.
    post:
      displayName: Update QuoteRequest in Store by Key
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_quote_requests:{projectKey}',
                  'manage_quote_requests:{projectKey}:{storeKey}',
                ],
            },
        ]
      body:
        application/json:
          example: !include ../examples/quote-request-update.example.json
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/quote-request-update-response.example.json
    delete:
      displayName: Delete QuoteRequest in Store by Key
      is:
        - dataErasure
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_quote_requests:{projectKey}',
                  'manage_quote_requests:{projectKey}:{storeKey}',
                ],
            },
        ]
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/quote-request.example.json
  /{ID}:
    (methodName): withId
    type:
      baseResource:
        uriParameterName: ID
        resourceType: QuoteRequest
        resourceUpdateType: QuoteRequestUpdate
    get:
      displayName: Get QuoteRequest in Store by ID
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_quote_requests:{projectKey}',
                  'view_quote_requests:{projectKey}:{storeKey}',
                ],
            },
        ]
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/quote-request.example.json
    head:
      displayName: Check if QuoteRequest exists in Store by ID
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_quote_requests:{projectKey}',
                  'view_quote_requests:{projectKey}:{storeKey}',
                ],
            },
        ]
      description: Checks if a QuoteRequest exists with the provided `id`. Returns a `200 OK` status if the QuoteRequest exists or [Not Found](/../api/errors#404-not-found) otherwise.
    post:
      displayName: Update QuoteRequest in Store by ID
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_quote_requests:{projectKey}',
                  'manage_quote_requests:{projectKey}:{storeKey}',
                ],
            },
        ]
      body:
        application/json:
          example: !include ../examples/quote-request-update.example.json
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/quote-request-update-response.example.json
    delete:
      displayName: Delete QuoteRequest in Store by ID
      is:
        - dataErasure
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_quote_requests:{projectKey}',
                  'manage_quote_requests:{projectKey}:{storeKey}',
                ],
            },
        ]
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/quote-request.example.json
/staged-quotes:
  type:
    baseDomain:
      resourceType: StagedQuote
      resourceQueryType: StagedQuotePagedQueryResponse
      resourceDraft: StagedQuoteDraft
      whereExample: 'stagedQuoteState = "InProgress"'
      sortExample: createdAt asc
  (updateable): StagedQuote
  (deleteable): StagedQuote
  (createable): StagedQuoteDraft
  description: A staged quote holds the negotiation between the [Buyer](/../api/quotes-overview#buyer) and the [Seller](/../api/quotes-overview#seller).
  get:
    displayName: Query StagedQuotes in Store
    securedBy:
      [
        oauth_2_0:
          {
            scopes:
              [
                'view_staged_quotes:{projectKey}',
                'view_staged_quotes:{projectKey}:{storeKey}',
              ],
          },
      ]
    responses:
      200:
        body:
          application/json:
            example: !include ../examples/staged-quotes.example.json
  head:
    displayName: Check if StagedQuote exists in Store by Query Predicate
    securedBy:
      [
        oauth_2_0:
          {
            scopes:
              [
                'view_staged_quotes:{projectKey}',
                'view_staged_quotes:{projectKey}:{storeKey}',
              ],
          },
      ]
    description: Checks if one or more StagedQuotes exist for the provided query predicate. Returns a `200 OK` status if any StagedQuotes match the query predicate, or [Not Found](/../api/errors#404-not-found) otherwise.
    queryParameters:
      where?:
        type: QueryPredicate[]
  post:
    displayName: Create StagedQuote in Store
    securedBy:
      [
        oauth_2_0:
          {
            scopes:
              [
                'manage_staged_quotes:{projectKey}',
                'manage_staged_quotes:{projectKey}:{storeKey}',
              ],
          },
      ]
    body:
      application/json:
        example: !include ../examples/staged-quote-create.example.json
    responses:
      201:
        body:
          application/json:
            example: !include ../examples/staged-quote.example.json
  /key={key}:
    (methodName): withKey
    type:
      baseResource:
        uriParameterName: key
        resourceType: StagedQuote
        resourceUpdateType: StagedQuoteUpdate
    get:
      displayName: Get StagedQuote in Store by Key
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_staged_quotes:{projectKey}',
                  'view_staged_quotes:{projectKey}:{storeKey}',
                ],
            },
        ]
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/staged-quote.example.json
    head:
      displayName: Check if StagedQuote exists in Store by Key
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_staged_quotes:{projectKey}',
                  'view_staged_quotes:{projectKey}:{storeKey}',
                ],
            },
        ]
      description: Checks if a StagedQuote exists with the provided `key`. Returns a `200 OK` status if the StagedQuote exists or [Not Found](/../api/errors#404-not-found) otherwise.
    post:
      displayName: Update StagedQuote in Store by Key
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_staged_quotes:{projectKey}',
                  'manage_staged_quotes:{projectKey}:{storeKey}',
                ],
            },
        ]
      body:
        application/json:
          example: !include ../examples/staged-quote-update.example.json
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/staged-quote.example.json
    delete:
      displayName: Delete StagedQuote in Store by Key
      is:
        - dataErasure
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_staged_quotes:{projectKey}',
                  'manage_staged_quotes:{projectKey}:{storeKey}',
                ],
            },
        ]
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/staged-quote.example.json
  /{ID}:
    (methodName): withId
    type:
      baseResource:
        uriParameterName: ID
        resourceType: StagedQuote
        resourceUpdateType: StagedQuoteUpdate
    get:
      displayName: Get StagedQuote in Store by ID
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_staged_quotes:{projectKey}',
                  'view_staged_quotes:{projectKey}:{storeKey}',
                ],
            },
        ]
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/staged-quote.example.json
    head:
      displayName: Check if StagedQuote exists in Store by ID
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_staged_quotes:{projectKey}',
                  'view_staged_quotes:{projectKey}:{storeKey}',
                ],
            },
        ]
      description: Checks if a StagedQuote exists with the provided `id`. Returns a `200 OK` status if the StagedQuote exists or [Not Found](/../api/errors#404-not-found) otherwise.
    post:
      displayName: Update StagedQuote in Store by ID
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_staged_quotes:{projectKey}',
                  'manage_staged_quotes:{projectKey}:{storeKey}',
                ],
            },
        ]
      body:
        application/json:
          example: !include ../examples/staged-quote-update.example.json
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/staged-quote.example.json
    delete:
      displayName: Delete StagedQuote in Store by ID
      is:
        - dataErasure
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_staged_quotes:{projectKey}',
                  'manage_staged_quotes:{projectKey}:{storeKey}',
                ],
            },
        ]
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/staged-quote.example.json
/quotes:
  type:
    baseDomain:
      resourceType: Quote
      resourceQueryType: QuotePagedQueryResponse
      resourceDraft: QuoteDraft
      whereExample: 'quoteState = "Accepted"'
      sortExample: createdAt asc
  (updateable): Quote
  (deleteable): Quote
  (createable): QuoteDraft
  description: A quote holds the negotiated offer.
  get:
    displayName: Query Quotes in Store
    securedBy:
      [
        oauth_2_0:
          {
            scopes:
              [
                'view_quotes:{projectKey}',
                'view_quotes:{projectKey}:{storeKey}',
              ],
          },
      ]
    responses:
      200:
        body:
          application/json:
            example: !include ../examples/quotes.example.json
  head:
    displayName: Check if Quote exists in Store by Query Predicate
    securedBy:
      [
        oauth_2_0:
          {
            scopes:
              [
                'view_quotes:{projectKey}',
                'view_quotes:{projectKey}:{storeKey}',
              ],
          },
      ]
    description: Checks if one or more Quotes exist for the provided query predicate. Returns a `200 OK` status if any Quotes match the query predicate, or [Not Found](/../api/errors#404-not-found) otherwise.
    queryParameters:
      where?:
        type: QueryPredicate[]
  post:
    displayName: Create Quote in Store
    securedBy:
      [
        oauth_2_0:
          {
            scopes:
              [
                'manage_quotes:{projectKey}',
                'manage_quotes:{projectKey}:{storeKey}',
              ],
          },
      ]
    body:
      application/json:
        example: !include ../examples/quote-create.example.json
    responses:
      201:
        body:
          application/json:
            example: !include ../examples/quote.example.json
  /key={key}:
    (methodName): withKey
    type:
      baseResource:
        uriParameterName: key
        resourceType: Quote
        resourceUpdateType: QuoteUpdate
    get:
      displayName: Get Quote in Store by Key
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_quotes:{projectKey}',
                  'view_quotes:{projectKey}:{storeKey}',
                ],
            },
        ]
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/quote.example.json
    head:
      displayName: Check if Quote exists in Store by Key
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_quotes:{projectKey}',
                  'view_quotes:{projectKey}:{storeKey}',
                ],
            },
        ]
      description: Checks if a Quote exists with the provided `key`. Returns a `200 OK` status if the Quote exists or [Not Found](/../api/errors#404-not-found) otherwise.
    post:
      displayName: Update Quote in Store by Key
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_quotes:{projectKey}',
                  'manage_quotes:{projectKey}:{storeKey}',
                ],
            },
        ]
      body:
        application/json:
          example: !include ../examples/quote-update.example.json
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/quote.example.json
    delete:
      displayName: Delete Quote in Store by Key
      is:
        - dataErasure
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_quotes:{projectKey}',
                  'manage_quotes:{projectKey}:{storeKey}',
                ],
            },
        ]
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/quote.example.json
  /{ID}:
    (methodName): withId
    type:
      baseResource:
        uriParameterName: ID
        resourceType: Quote
        resourceUpdateType: QuoteUpdate
    get:
      displayName: Get Quote in Store by ID
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_quotes:{projectKey}',
                  'view_quotes:{projectKey}:{storeKey}',
                ],
            },
        ]
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/quote.example.json
    head:
      displayName: Check if Quote exists in Store by ID
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_quotes:{projectKey}',
                  'view_quotes:{projectKey}:{storeKey}',
                ],
            },
        ]
      description: Checks if a Quote exists with the provided `id`. Returns a `200 OK` status if the Quote exists or [Not Found](/../api/errors#404-not-found) otherwise.
    post:
      displayName: Update Quote in Store by ID
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_quotes:{projectKey}',
                  'manage_quotes:{projectKey}:{storeKey}',
                ],
            },
        ]
      body:
        application/json:
          example: !include ../examples/quote-update.example.json
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/quote.example.json
    delete:
      displayName: Delete Quote in Store by ID
      is:
        - dataErasure
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_quotes:{projectKey}',
                  'manage_quotes:{projectKey}:{storeKey}',
                ],
            },
        ]
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/quote.example.json
/business-units:
  type:
    baseDomain:
      resourceType: BusinessUnit
      resourceQueryType: BusinessUnitPagedQueryResponse
      resourceDraft: BusinessUnitDraft
      whereExample: 'name = "Some company"'
      sortExample: createdAt asc
  (updateable): BusinessUnit
  (deleteable): BusinessUnit
  (createable): BusinessUnitDraft
  description: A Business Unit can represent a Company or a Division.
  get:
    displayName: Query BusinessUnits in Store
    securedBy:
      [
        oauth_2_0:
          {
            scopes:
              [
                'view_business_units:{projectKey}',
                'view_business_units:{projectKey}:{storeKey}',
              ],
          },
      ]
    responses:
      200:
        body:
          application/json:
            example: !include ../examples/business-units.example.json
  head:
    displayName: Check if BusinessUnit exists in Store by Query Predicate
    securedBy:
      [
        oauth_2_0:
          {
            scopes:
              [
                'view_business_units:{projectKey}',
                'view_business_units:{projectKey}:{storeKey}',
              ],
          },
      ]
    description: Checks if one or more BusinessUnits exist for the provided query predicate. Returns a `200 OK` status if any BusinessUnits match the query predicate, or a `404 Not Found` otherwise.
    queryParameters:
      where?:
        type: QueryPredicate[]
  post:
    displayName: Create BusinessUnit in Store
    securedBy:
      [
        oauth_2_0:
          {
            scopes:
              [
                'manage_business_units:{projectKey}',
                'manage_business_units:{projectKey}:{storeKey}',
              ],
          },
      ]
    body:
      application/json:
        example: !include ../examples/business-unit-create.example.json
    responses:
      201:
        body:
          application/json:
            example: !include ../examples/business-unit.example.json
  /key={key}:
    (methodName): withKey
    type:
      baseResource:
        uriParameterName: key
        resourceType: BusinessUnit
        resourceUpdateType: BusinessUnitUpdate
    get:
      displayName: Get BusinessUnit in Store by Key
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_business_units:{projectKey}',
                  'view_business_units:{projectKey}:{storeKey}',
                ],
            },
        ]
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/business-unit.example.json
    head:
      displayName: Check if BusinessUnit exists in Store by Key
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_business_units:{projectKey}',
                  'view_business_units:{projectKey}:{storeKey}',
                ],
            },
        ]
      description: Checks if a BusinessUnit exists with the provided `key`. Returns a `200 OK` status if the BusinessUnit exists or a `404 Not Found` otherwise.
    post:
      displayName: Update BusinessUnit in Store by Key
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_business_units:{projectKey}',
                  'manage_business_units:{projectKey}:{storeKey}',
                ],
            },
        ]
      body:
        application/json:
          example: !include ../examples/business-unit-update.example.json
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/business-unit.example.json
    delete:
      displayName: Delete BusinessUnit in Store by Key
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_business_units:{projectKey}',
                  'manage_business_units:{projectKey}:{storeKey}',
                ],
            },
        ]
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/business-unit.example.json
  /{ID}:
    (methodName): withId
    type:
      baseResource:
        uriParameterName: ID
        resourceType: BusinessUnit
        resourceUpdateType: BusinessUnitUpdate
    get:
      displayName: Get BusinessUnit in Store by ID
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_business_units:{projectKey}',
                  'view_business_units:{projectKey}:{storeKey}',
                ],
            },
        ]
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/business-unit.example.json
    head:
      displayName: Check if BusinessUnit exists in Store by ID
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'view_business_units:{projectKey}',
                  'view_business_units:{projectKey}:{storeKey}',
                ],
            },
        ]
      description: Checks if a BusinessUnit exists with the provided `id`. Returns a `200 OK` status if the BusinessUnit exists or a `404 Not Found` otherwise.
    post:
      displayName: Update BusinessUnit in Store by ID
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_business_units:{projectKey}',
                  'manage_business_units:{projectKey}:{storeKey}',
                ],
            },
        ]
      body:
        application/json:
          example: !include ../examples/business-unit-update.example.json
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/business-unit.example.json
    delete:
      displayName: Delete BusinessUnit in Store by ID
      securedBy:
        [
          oauth_2_0:
            {
              scopes:
                [
                  'manage_business_units:{projectKey}',
                  'manage_business_units:{projectKey}:{storeKey}',
                ],
            },
        ]
      responses:
        200:
          body:
            application/json:
              example: !include ../examples/business-unit.example.json
  /key={key}/associates/{associateId}:
    type: base
    uriParameters:
      key:
        type: string
        description: '`key` of the [BusinessUnit](ctp:api:type:BusinessUnit).'
      associateId:
        type: string
        description: '`id` of the [Customer](ctp:api:type:Customer) acting as an Associate in the Business Unit.'
    get:
      displayName: Get Associate in BusinessUnit in Store by Key
      description: |
        Retrieves roles and permissions of an Associate in a Business Unit in a Store.
      securedBy: [oauth_2_0: { scopes: ['view_business_units:{projectKey}'] }]
      responses:
        200:
          body:
            application/json:
              type: BusinessUnitAssociateResponse
              example: !include ../examples/BusinessUnit/BusinessUnitAssociateResponseExample.json
  /{businessUnitId}/associates/{associateId}:
    type: base
    uriParameters:
      businessUnitId:
        type: string
        description: '`id` of the [BusinessUnit](ctp:api:type:BusinessUnit).'
      associateId:
        type: string
        description: '`id` of the [Customer](ctp:api:type:Customer) acting as an Associate in the Business Unit.'
    get:
      displayName: Get Associate in BusinessUnit in Store by ID
      description: |
        Retrieves roles and permissions of an Associate in a Business Unit in a Store.
      securedBy: [oauth_2_0: { scopes: ['view_business_units:{projectKey}'] }]
      responses:
        200:
          body:
            application/json:
              type: BusinessUnitAssociateResponse
              example: !include ../examples/BusinessUnit/BusinessUnitAssociateResponseExample.json
